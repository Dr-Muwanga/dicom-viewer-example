(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gr=Symbol("Comlink.proxy"),vs=Symbol("Comlink.endpoint"),ds=Symbol("Comlink.releaseProxy"),nn=Symbol("Comlink.finalizer"),ue=Symbol("Comlink.thrown"),yr=e=>typeof e=="object"&&e!==null||typeof e=="function",ms={canHandle:e=>yr(e)&&e[gr],serialize(e){const{port1:t,port2:n}=new MessageChannel;return rn(e,t),[n,[n]]},deserialize(e){return e.start(),Es(e)}},Ts={canHandle:e=>yr(e)&&ue in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},hr=new Map([["proxy",ms],["throw",Ts]]);function ws(e,t){for(const n of e)if(t===n||n==="*"||n instanceof RegExp&&n.test(t))return!0;return!1}function rn(e,t=globalThis,n=["*"]){t.addEventListener("message",function r(a){if(!a||!a.data)return;if(!ws(n,a.origin)){console.warn(`Invalid origin '${a.origin}' for comlink proxy`);return}const{id:i,type:s,path:u}=Object.assign({path:[]},a.data),o=(a.data.argumentList||[]).map(Ft);let c;try{const f=u.slice(0,-1).reduce((y,p)=>y[p],e),g=u.reduce((y,p)=>y[p],e);switch(s){case"GET":c=g;break;case"SET":f[u.slice(-1)[0]]=Ft(a.data.value),c=!0;break;case"APPLY":c=g.apply(f,o);break;case"CONSTRUCT":{const y=new g(...o);c=Ds(y)}break;case"ENDPOINT":{const{port1:y,port2:p}=new MessageChannel;rn(e,p),c=xs(y,[y])}break;case"RELEASE":c=void 0;break;default:return}}catch(f){c={value:f,[ue]:0}}Promise.resolve(c).catch(f=>({value:f,[ue]:0})).then(f=>{const[g,y]=ge(f);t.postMessage(Object.assign(Object.assign({},g),{id:i}),y),s==="RELEASE"&&(t.removeEventListener("message",r),pr(t),nn in e&&typeof e[nn]=="function"&&e[nn]())}).catch(f=>{const[g,y]=ge({value:new TypeError("Unserializable return value"),[ue]:0});t.postMessage(Object.assign(Object.assign({},g),{id:i}),y)})}),t.start&&t.start()}function _s(e){return e.constructor.name==="MessagePort"}function pr(e){_s(e)&&e.close()}function Es(e,t){return an(e,[],t)}function ce(e){if(e)throw new Error("Proxy has been released and is not useable")}function vr(e){return Bt(e,{type:"RELEASE"}).then(()=>{pr(e)})}const fe=new WeakMap,le="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(fe.get(e)||0)-1;fe.set(e,t),t===0&&vr(e)});function Cs(e,t){const n=(fe.get(t)||0)+1;fe.set(t,n),le&&le.register(e,t,e)}function Os(e){le&&le.unregister(e)}function an(e,t=[],n=function(){}){let r=!1;const a=new Proxy(n,{get(i,s){if(ce(r),s===ds)return()=>{Os(a),vr(e),r=!0};if(s==="then"){if(t.length===0)return{then:()=>a};const u=Bt(e,{type:"GET",path:t.map(o=>o.toString())}).then(Ft);return u.then.bind(u)}return an(e,[...t,s])},set(i,s,u){ce(r);const[o,c]=ge(u);return Bt(e,{type:"SET",path:[...t,s].map(f=>f.toString()),value:o},c).then(Ft)},apply(i,s,u){ce(r);const o=t[t.length-1];if(o===vs)return Bt(e,{type:"ENDPOINT"}).then(Ft);if(o==="bind")return an(e,t.slice(0,-1));const[c,f]=dr(u);return Bt(e,{type:"APPLY",path:t.map(g=>g.toString()),argumentList:c},f).then(Ft)},construct(i,s){ce(r);const[u,o]=dr(s);return Bt(e,{type:"CONSTRUCT",path:t.map(c=>c.toString()),argumentList:u},o).then(Ft)}});return Cs(a,e),a}function Ss(e){return Array.prototype.concat.apply([],e)}function dr(e){const t=e.map(ge);return[t.map(n=>n[0]),Ss(t.map(n=>n[1]))]}const mr=new WeakMap;function xs(e,t){return mr.set(e,t),e}function Ds(e){return Object.assign(e,{[gr]:!0})}function ge(e){for(const[t,n]of hr)if(n.canHandle(e)){const[r,a]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},a]}return[{type:"RAW",value:e},mr.get(e)||[]]}function Ft(e){switch(e.type){case"HANDLER":return hr.get(e.name).deserialize(e.value);case"RAW":return e.value}}function Bt(e,t,n){return new Promise(r=>{const a=As();e.addEventListener("message",function i(s){!s.data||!s.data.id||s.data.id!==a||(e.removeEventListener("message",i),r(s.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),n)})}function As(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var yt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ms(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),n}var ks=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,a,i;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(a=r;a--!==0;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(i=Object.keys(t),r=i.length,r!==Object.keys(n).length)return!1;for(a=r;a--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=r;a--!==0;){var s=i[a];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n},Ls=Tr(ks),wr=Object.prototype.toString,_r=function(t){var n=wr.call(t),r=n==="[object Arguments]";return r||(r=n!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&wr.call(t.callee)==="[object Function]"),r},sn,Er;function Ns(){if(Er)return sn;Er=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=_r,a=Object.prototype.propertyIsEnumerable,i=!a.call({toString:null},"toString"),s=a.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=function(y){var p=y.constructor;return p&&p.prototype===y},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if(typeof window>"u")return!1;for(var y in window)try{if(!c["$"+y]&&t.call(window,y)&&window[y]!==null&&typeof window[y]=="object")try{o(window[y])}catch{return!0}}catch{return!0}return!1}(),g=function(y){if(typeof window>"u"||!f)return o(y);try{return o(y)}catch{return!1}};e=function(p){var d=p!==null&&typeof p=="object",m=n.call(p)==="[object Function]",x=r(p),L=d&&n.call(p)==="[object String]",A=[];if(!d&&!m&&!x)throw new TypeError("Object.keys called on a non-object");var _=s&&m;if(L&&p.length>0&&!t.call(p,0))for(var D=0;D<p.length;++D)A.push(String(D));if(x&&p.length>0)for(var R=0;R<p.length;++R)A.push(String(R));else for(var M in p)!(_&&M==="prototype")&&t.call(p,M)&&A.push(String(M));if(i)for(var b=g(p),k=0;k<u.length;++k)!(b&&u[k]==="constructor")&&t.call(p,u[k])&&A.push(u[k]);return A}}return sn=e,sn}var Rs=Array.prototype.slice,bs=_r,Cr=Object.keys,ye=Cr?function(t){return Cr(t)}:Ns(),Or=Object.keys;ye.shim=function(){if(Object.keys){var t=function(){var n=Object.keys(arguments);return n&&n.length===arguments.length}(1,2);t||(Object.keys=function(r){return bs(r)?Or(Rs.call(r)):Or(r)})}else Object.keys=ye;return Object.keys||ye};var Is=ye,Fs=Error,$s=EvalError,Vs=RangeError,Us=ReferenceError,Sr=SyntaxError,xr=TypeError,js=URIError,Ps=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var a=42;t[n]=a;for(n in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==n||!Object.prototype.propertyIsEnumerable.call(t,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(t,n);if(s.value!==a||s.enumerable!==!0)return!1}return!0},Dr=typeof Symbol<"u"&&Symbol,zs=Ps,Hs=function(){return typeof Dr!="function"||typeof Symbol!="function"||typeof Dr("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:zs()},on={__proto__:null,foo:{}},Gs=Object,Ws=function(){return{__proto__:on}.foo===on.foo&&!(on instanceof Gs)},Bs="Function.prototype.bind called on incompatible ",Ks=Object.prototype.toString,Ys=Math.max,Xs="[object Function]",Ar=function(t,n){for(var r=[],a=0;a<t.length;a+=1)r[a]=t[a];for(var i=0;i<n.length;i+=1)r[i+t.length]=n[i];return r},Qs=function(t,n){for(var r=[],a=n,i=0;a<t.length;a+=1,i+=1)r[i]=t[a];return r},Js=function(e,t){for(var n="",r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n},qs=function(t){var n=this;if(typeof n!="function"||Ks.apply(n)!==Xs)throw new TypeError(Bs+n);for(var r=Qs(arguments,1),a,i=function(){if(this instanceof a){var f=n.apply(this,Ar(r,arguments));return Object(f)===f?f:this}return n.apply(t,Ar(r,arguments))},s=Ys(0,n.length-r.length),u=[],o=0;o<s;o++)u[o]="$"+o;if(a=Function("binder","return function ("+Js(u,",")+"){ return binder.apply(this,arguments); }")(i),n.prototype){var c=function(){};c.prototype=n.prototype,a.prototype=new c,c.prototype=null}return a},Zs=qs,Mr=Function.prototype.bind||Zs,to=Function.prototype.call,eo=Object.prototype.hasOwnProperty,no=Mr,ro=no.call(to,eo),Y,ao=Fs,io=$s,so=Vs,oo=Us,Kt=Sr,Yt=xr,uo=js,kr=Function,un=function(e){try{return kr('"use strict"; return ('+e+").constructor;")()}catch{}},$t=Object.getOwnPropertyDescriptor;if($t)try{$t({},"")}catch{$t=null}var cn=function(){throw new Yt},co=$t?function(){try{return arguments.callee,cn}catch{try{return $t(arguments,"callee").get}catch{return cn}}}():cn,Xt=Hs(),fo=Ws(),tt=Object.getPrototypeOf||(fo?function(e){return e.__proto__}:null),Qt={},lo=typeof Uint8Array>"u"||!tt?Y:tt(Uint8Array),Vt={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Y:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Y:ArrayBuffer,"%ArrayIteratorPrototype%":Xt&&tt?tt([][Symbol.iterator]()):Y,"%AsyncFromSyncIteratorPrototype%":Y,"%AsyncFunction%":Qt,"%AsyncGenerator%":Qt,"%AsyncGeneratorFunction%":Qt,"%AsyncIteratorPrototype%":Qt,"%Atomics%":typeof Atomics>"u"?Y:Atomics,"%BigInt%":typeof BigInt>"u"?Y:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Y:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Y:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Y:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":ao,"%eval%":eval,"%EvalError%":io,"%Float32Array%":typeof Float32Array>"u"?Y:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Y:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Y:FinalizationRegistry,"%Function%":kr,"%GeneratorFunction%":Qt,"%Int8Array%":typeof Int8Array>"u"?Y:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Y:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Y:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Xt&&tt?tt(tt([][Symbol.iterator]())):Y,"%JSON%":typeof JSON=="object"?JSON:Y,"%Map%":typeof Map>"u"?Y:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Xt||!tt?Y:tt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Y:Promise,"%Proxy%":typeof Proxy>"u"?Y:Proxy,"%RangeError%":so,"%ReferenceError%":oo,"%Reflect%":typeof Reflect>"u"?Y:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Y:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Xt||!tt?Y:tt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Y:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Xt&&tt?tt(""[Symbol.iterator]()):Y,"%Symbol%":Xt?Symbol:Y,"%SyntaxError%":Kt,"%ThrowTypeError%":co,"%TypedArray%":lo,"%TypeError%":Yt,"%Uint8Array%":typeof Uint8Array>"u"?Y:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Y:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Y:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Y:Uint32Array,"%URIError%":uo,"%WeakMap%":typeof WeakMap>"u"?Y:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Y:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Y:WeakSet};if(tt)try{null.error}catch(e){var go=tt(tt(e));Vt["%Error.prototype%"]=go}var yo=function e(t){var n;if(t==="%AsyncFunction%")n=un("async function () {}");else if(t==="%GeneratorFunction%")n=un("function* () {}");else if(t==="%AsyncGeneratorFunction%")n=un("async function* () {}");else if(t==="%AsyncGenerator%"){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var a=e("%AsyncGenerator%");a&&tt&&(n=tt(a.prototype))}return Vt[t]=n,n},Lr={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ne=Mr,he=ro,ho=ne.call(Function.call,Array.prototype.concat),po=ne.call(Function.apply,Array.prototype.splice),Nr=ne.call(Function.call,String.prototype.replace),pe=ne.call(Function.call,String.prototype.slice),vo=ne.call(Function.call,RegExp.prototype.exec),mo=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,To=/\\(\\)?/g,wo=function(t){var n=pe(t,0,1),r=pe(t,-1);if(n==="%"&&r!=="%")throw new Kt("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Kt("invalid intrinsic syntax, expected opening `%`");var a=[];return Nr(t,mo,function(i,s,u,o){a[a.length]=u?Nr(o,To,"$1"):s||i}),a},_o=function(t,n){var r=t,a;if(he(Lr,r)&&(a=Lr[r],r="%"+a[0]+"%"),he(Vt,r)){var i=Vt[r];if(i===Qt&&(i=yo(r)),typeof i>"u"&&!n)throw new Yt("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:a,name:r,value:i}}throw new Kt("intrinsic "+t+" does not exist!")},Rr=function(t,n){if(typeof t!="string"||t.length===0)throw new Yt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Yt('"allowMissing" argument must be a boolean');if(vo(/^%?[^%]*%?$/,t)===null)throw new Kt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=wo(t),a=r.length>0?r[0]:"",i=_o("%"+a+"%",n),s=i.name,u=i.value,o=!1,c=i.alias;c&&(a=c[0],po(r,ho([0,1],c)));for(var f=1,g=!0;f<r.length;f+=1){var y=r[f],p=pe(y,0,1),d=pe(y,-1);if((p==='"'||p==="'"||p==="`"||d==='"'||d==="'"||d==="`")&&p!==d)throw new Kt("property names with quotes must have matching quotes");if((y==="constructor"||!g)&&(o=!0),a+="."+y,s="%"+a+"%",he(Vt,s))u=Vt[s];else if(u!=null){if(!(y in u)){if(!n)throw new Yt("base intrinsic for "+t+" exists, but the property is not available.");return}if($t&&f+1>=r.length){var m=$t(u,y);g=!!m,g&&"get"in m&&!("originalValue"in m.get)?u=m.get:u=u[y]}else g=he(u,y),u=u[y];g&&!o&&(Vt[s]=u)}}return u},Eo=Rr,ve=Eo("%Object.defineProperty%",!0)||!1;if(ve)try{ve({},"a",{value:1})}catch{ve=!1}var br=ve,Co=Rr,de=Co("%Object.getOwnPropertyDescriptor%",!0);if(de)try{de([],"length")}catch{de=null}var Oo=de,Ir=br,So=Sr,Jt=xr,Fr=Oo,xo=function(t,n,r){if(!t||typeof t!="object"&&typeof t!="function")throw new Jt("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new Jt("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Jt("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Jt("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Jt("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Jt("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,s=arguments.length>5?arguments[5]:null,u=arguments.length>6?arguments[6]:!1,o=!!Fr&&Fr(t,n);if(Ir)Ir(t,n,{configurable:s===null&&o?o.configurable:!s,enumerable:a===null&&o?o.enumerable:!a,value:r,writable:i===null&&o?o.writable:!i});else if(u||!a&&!i&&!s)t[n]=r;else throw new So("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},fn=br,$r=function(){return!!fn};$r.hasArrayLengthDefineBug=function(){if(!fn)return null;try{return fn([],"length",{value:1}).length!==1}catch{return!0}};var Do=$r,Ao=Is,Mo=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",ko=Object.prototype.toString,Lo=Array.prototype.concat,Vr=xo,No=function(e){return typeof e=="function"&&ko.call(e)==="[object Function]"},Ur=Do(),Ro=function(e,t,n,r){if(t in e){if(r===!0){if(e[t]===n)return}else if(!No(r)||!r())return}Ur?Vr(e,t,n,!0):Vr(e,t,n)},jr=function(e,t){var n=arguments.length>2?arguments[2]:{},r=Ao(t);Mo&&(r=Lo.call(r,Object.getOwnPropertySymbols(t)));for(var a=0;a<r.length;a+=1)Ro(e,r[a],t[r[a]],n[r[a]])};jr.supportsDescriptors=!!Ur;var Pr=jr,me={exports:{}};typeof self<"u"?me.exports=self:typeof window<"u"?me.exports=window:me.exports=Function("return this")();var zr=me.exports,bo=zr,Hr=function(){return typeof yt!="object"||!yt||yt.Math!==Math||yt.Array!==Array?bo:yt},Io=Pr,Fo=Hr,$o=function(){var t=Fo();if(Io.supportsDescriptors){var n=Object.getOwnPropertyDescriptor(t,"globalThis");(!n||n.configurable&&(n.enumerable||!n.writable||globalThis!==t))&&Object.defineProperty(t,"globalThis",{configurable:!0,enumerable:!1,value:t,writable:!0})}else(typeof globalThis!="object"||globalThis!==t)&&(t.globalThis=t);return t},Vo=Pr,Uo=zr,Gr=Hr,jo=$o,Po=Gr(),Wr=function(){return Po};Vo(Wr,{getPolyfill:Gr,implementation:Uo,shim:jo});var zo=Wr,Ho=Tr(zo);const vt=Ho(),Br={vtkObject:()=>null};function dt(e){if(e==null||e.isA)return e;if(!e.vtkClass)return vt.console&&vt.console.error&&vt.console.error("Invalid VTK object"),null;const t=Br[e.vtkClass];if(!t)return vt.console&&vt.console.error&&vt.console.error(`No vtk class found for Object of type ${e.vtkClass}`),null;const n={...e};Object.keys(n).forEach(a=>{n[a]&&typeof n[a]=="object"&&n[a].vtkClass&&(n[a]=dt(n[a]))});const r=t(n);return r&&r.modified&&r.modified(),r}function Go(e,t){Br[e]=t}dt.register=Go;class ln extends Array{push(){for(let t=0;t<arguments.length;t++)this.includes(arguments[t])||super.push(arguments[t]);return this.length}}let gn=0;const Kr=Symbol("void");function Wo(){return gn}const Yr={};function Ut(){}["log","debug","info","warn","error","time","timeEnd","group","groupEnd"].forEach(e=>{Yr[e]=Ut}),vt.console=console.hasOwnProperty("log")?console:Yr;const Rt={debug:Ut,error:vt.console.error||Ut,info:vt.console.info||Ut,log:vt.console.log||Ut,warn:vt.console.warn||Ut};function Xr(e,t){Rt[e]&&(Rt[e]=t||Ut)}function Qr(){Rt.log(...arguments)}function Jr(){Rt.info(...arguments)}function Te(){Rt.debug(...arguments)}function Z(){Rt.error(...arguments)}function yn(){Rt.warn(...arguments)}const qr={};function Zr(e){qr[e]||(Rt.error(e),qr[e]=!0)}const nt=Object.create(null);nt.Float32Array=Float32Array,nt.Float64Array=Float64Array,nt.Uint8Array=Uint8Array,nt.Int8Array=Int8Array,nt.Uint16Array=Uint16Array,nt.Int16Array=Int16Array,nt.Uint32Array=Uint32Array,nt.Int32Array=Int32Array,nt.Uint8ClampedArray=Uint8ClampedArray;try{nt.BigInt64Array=BigInt64Array,nt.BigUint64Array=BigUint64Array}catch{}function we(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new(nt[e]||Float64Array)(...n)}function _e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(nt[e]||Float64Array).from(...n)}function Ee(e){return e.charAt(0).toUpperCase()+e.slice(1)}function q(e){return Ee(e[0]==="_"?e.slice(1):e)}function ta(e){return e.charAt(0).toLowerCase()+e.slice(1)}function ea(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;const r=["TB","GB","MB","KB"];let a=Number(e),i="B";for(;a>n;)a/=n,i=r.pop();return`${a.toFixed(t)} ${i}`}function na(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";const n=[];let r=e;for(;r>1e3;)n.push(`000${r%1e3}`.slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(t)}function ra(e){Object.keys(e).forEach(t=>{Array.isArray(e[t])&&(e[t]=[].concat(e[t]))})}function Bo(e){return Object.values(nt).some(t=>e instanceof t)}function Ko(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}function Yo(e,t){return Object.keys(e).find(n=>e[n]===t)}function aa(e){return e&&e.isA?e.getState():e}function hn(e){setTimeout(e,0)}function ia(e,t){const n=performance.now();e.finally(()=>{const r=performance.now()-n;t(r)})}function Ce(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ra(t);const n=[];if(Number.isInteger(t.mtime)||(t.mtime=++gn),!("classHierarchy"in t))t.classHierarchy=new ln("vtkObject");else if(!(t.classHierarchy instanceof ln)){const i=new ln;for(let s=0;s<t.classHierarchy.length;s++)i.push(t.classHierarchy[s]);t.classHierarchy=i}function r(i){n[i]=null}function a(i){function s(){r(i)}return Object.freeze({unsubscribe:s})}return e.isDeleted=()=>!!t.deleted,e.modified=i=>{if(t.deleted){Z("instance deleted - cannot call any method");return}i&&i<e.getMTime()||(t.mtime=++gn,n.forEach(s=>s&&s(e)))},e.onModified=i=>{if(t.deleted)return Z("instance deleted - cannot call any method"),null;const s=n.length;return n.push(i),a(s)},e.getMTime=()=>t.mtime,e.isA=i=>{let s=t.classHierarchy.length;for(;s--;)if(t.classHierarchy[s]===i)return!0;return!1},e.getClassName=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.classHierarchy[t.classHierarchy.length-1-i]},e.set=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1;return Object.keys(i).forEach(c=>{const f=u?null:e[`set${Ee(c)}`];f&&Array.isArray(i[c])&&f.length>1?o=f(...i[c])||o:f?o=f(i[c])||o:(["mtime"].indexOf(c)===-1&&!s&&yn(`Warning: Set value to model directly ${c}, ${i[c]}`),o=t[c]!==i[c]||o,t[c]=i[c])}),o},e.get=function(){for(var i=arguments.length,s=new Array(i),u=0;u<i;u++)s[u]=arguments[u];if(!s.length)return t;const o={};return s.forEach(c=>{o[c]=t[c]}),o},e.getReferenceByName=i=>t[i],e.delete=()=>{Object.keys(t).forEach(i=>delete t[i]),n.forEach((i,s)=>r(s)),t.deleted=!0},e.getState=()=>{if(t.deleted)return null;const i={...t,vtkClass:e.getClassName()};Object.keys(i).forEach(u=>{i[u]===null||i[u]===void 0||u[0]==="_"?delete i[u]:i[u].isA?i[u]=i[u].getState():Array.isArray(i[u])?i[u]=i[u].map(aa):Bo(i[u])&&(i[u]=Array.from(i[u]))});const s={};return Object.keys(i).sort().forEach(u=>{s[u]=i[u]}),s.mtime&&delete s.mtime,s},e.shallowCopy=function(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i.getClassName()!==e.getClassName())throw new Error(`Cannot ShallowCopy ${i.getClassName()} into ${e.getClassName()}`);const u=i.get(),o=Object.keys(t).sort();Object.keys(u).sort().forEach(f=>{const g=o.indexOf(f);g===-1?s&&Te(`add ${f} in shallowCopy`):o.splice(g,1),t[f]=u[f]}),o.length&&s&&Te(`Untouched keys: ${o.join(", ")}`),e.modified()},e.toJSON=function(){return e.getState()},e}const Xo={object(e,t,n){return function(){return{...t[n.name]}}}};function re(e,t,n){n.forEach(r=>{if(typeof r=="object"){const a=Xo[r.type];a?e[`get${q(r.name)}`]=a(e,t,r):e[`get${q(r.name)}`]=()=>t[r.name]}else e[`get${q(r)}`]=()=>t[r]})}const Qo={enum(e,t,n){const r=`_on${q(n.name)}Changed`;return a=>{var i;if(typeof a=="string"){if(n.enum[a]!==void 0)return t[n.name]!==n.enum[a]?(t[n.name]=n.enum[a],e.modified(),!0):!1;throw Z(`Set Enum with invalid argument ${n}, ${a}`),new RangeError("Set Enum with invalid string argument")}if(typeof a=="number"){if(t[n.name]!==a){if(Object.keys(n.enum).map(s=>n.enum[s]).indexOf(a)!==-1){const s=t[n.name];return t[n.name]=a,(i=t[r])==null||i.call(t,e,t,a,s),e.modified(),!0}throw Z(`Set Enum outside numeric range ${n}, ${a}`),new RangeError("Set Enum outside numeric range")}return!1}throw Z(`Set Enum with invalid argument (String/Number) ${n}, ${a}`),new TypeError("Set Enum with invalid argument (String/Number)")}},object(e,t,n){const r=`_on${q(n.name)}Changed`;return a=>{var i;if(!Ls(t[n.name],a)){const s=t[n.name];return t[n.name]=a,(i=t[r])==null||i.call(t,e,t,a,s),e.modified(),!0}return!1}}};function sa(e){if(typeof e=="object"){const t=Qo[e.type];if(t)return(n,r)=>t(n,r,e);throw Z(`No setter for field ${e}`),new TypeError("No setter for field")}return function(n,r){const a=`_on${q(e)}Changed`;return function(s){var u;if(r.deleted)return Z("instance deleted - cannot call any method"),!1;if(r[e]!==s){const o=r[e.name];return r[e]=s,(u=r[a])==null||u.call(r,n,r,s,o),n.modified(),!0}return!1}}}function Oe(e,t,n){n.forEach(r=>{typeof r=="object"?e[`set${q(r.name)}`]=sa(r)(e,t):e[`set${q(r)}`]=sa(r)(e,t)})}function Se(e,t,n){re(e,t,n),Oe(e,t,n)}function pn(e,t,n){n.forEach(r=>{e[`get${q(r)}`]=()=>t[r]?Array.from(t[r]):t[r],e[`get${q(r)}ByReference`]=()=>t[r]})}function vn(e,t,n,r){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;n.forEach(i=>{if(t[i]&&r&&t[i].length!==r)throw new RangeError(`Invalid initial number of values for array (${i})`);const s=`_on${q(i)}Changed`;e[`set${q(i)}`]=function(){var p;if(t.deleted)return Z("instance deleted - cannot call any method"),!1;for(var u=arguments.length,o=new Array(u),c=0;c<u;c++)o[c]=arguments[c];let f=o,g,y=!1;if(f.length===1&&(f[0]==null||f[0].length>=0)&&(f=f[0],y=!0),f==null)g=t[i]!==f;else{if(r&&f.length!==r)if(f.length<r&&a!==void 0)for(f=Array.from(f),y=!1;f.length<r;)f.push(a);else throw new RangeError(`Invalid number of values for array setter (${i})`);g=t[i]==null||t[i].length!==f.length;for(let d=0;!g&&d<f.length;++d)g=t[i][d]!==f[d];g&&y&&(f=Array.from(f))}if(g){const d=t[i.name];t[i]=f,(p=t[s])==null||p.call(t,e,t,f,d),e.modified()}return g},e[`set${q(i)}From`]=u=>{const o=t[i];u.forEach((c,f)=>{o[f]=c})}})}function oa(e,t,n,r){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;pn(e,t,n),vn(e,t,n,r,a)}function ua(e,t,n){for(let r=0;r<n.length;r++){const a=n[r];t[a]!==void 0&&(t[`_${a}`]=t[a],delete t[a])}}function dn(e,t,n,r){t.inputData?t.inputData=t.inputData.map(dt):t.inputData=[],t.inputConnection?t.inputConnection=t.inputConnection.map(dt):t.inputConnection=[],t.output?t.output=t.output.map(dt):t.output=[],t.inputArrayToProcess?t.inputArrayToProcess=t.inputArrayToProcess.map(dt):t.inputArrayToProcess=[],t.numberOfInputs=n;function a(p){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(t.deleted){Z("instance deleted - cannot call any method");return}if(d>=t.numberOfInputs){Z(`algorithm ${e.getClassName()} only has ${t.numberOfInputs} input ports. To add more input ports, use addInputData()`);return}(t.inputData[d]!==p||t.inputConnection[d])&&(t.inputData[d]=p,t.inputConnection[d]=null,e.modified&&e.modified())}function i(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.inputConnection[p]&&(t.inputData[p]=t.inputConnection[p]()),t.inputData[p]}function s(p){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(t.deleted){Z("instance deleted - cannot call any method");return}if(d>=t.numberOfInputs){let m=`algorithm ${e.getClassName()} only has `;m+=`${t.numberOfInputs}`,m+=" input ports. To add more input ports, use addInputConnection()",Z(m);return}t.inputData[d]=null,t.inputConnection[d]=p}function u(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.inputConnection[p]}function o(){let p=t.numberOfInputs;for(;p&&!t.inputData[p-1]&&!t.inputConnection[p-1];)p--;return p===t.numberOfInputs&&t.numberOfInputs++,p}function c(p){if(t.deleted){Z("instance deleted - cannot call any method");return}s(p,o())}function f(p){if(t.deleted){Z("instance deleted - cannot call any method");return}a(p,o())}function g(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.deleted?(Z("instance deleted - cannot call any method"),null):(e.shouldUpdate()&&e.update(),t.output[p])}e.shouldUpdate=()=>{var x,L;const p=e.getMTime();let d=1/0,m=r;for(;m--;){if(!t.output[m]||t.output[m].isDeleted())return!0;const A=t.output[m].getMTime();if(A<p)return!0;A<d&&(d=A)}for(m=t.numberOfInputs;m--;)if((x=t.inputConnection[m])!=null&&x.filter.shouldUpdate()||((L=e.getInputData(m))==null?void 0:L.getMTime())>d)return!0;return!1};function y(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const d=()=>g(p);return d.filter=e,d}if(t.numberOfInputs){let p=t.numberOfInputs;for(;p--;)t.inputData.push(null),t.inputConnection.push(null);e.setInputData=a,e.setInputConnection=s,e.addInputData=f,e.addInputConnection=c,e.getInputData=i,e.getInputConnection=u}r&&(e.getOutputData=g,e.getOutputPort=y),e.update=()=>{const p=[];if(t.numberOfInputs){let d=0;for(;d<t.numberOfInputs;)p[d]=e.getInputData(d),d++}e.shouldUpdate()&&e.requestData&&e.requestData(p,t.output)},e.getNumberOfInputPorts=()=>t.numberOfInputs,e.getNumberOfOutputPorts=()=>r||t.output.length,e.getInputArrayToProcess=p=>{const d=t.inputArrayToProcess[p],m=t.inputData[p];return d&&m?m[`get${d.fieldAssociation}`]().getArray(d.arrayName):null},e.setInputArrayToProcess=function(p,d,m){let x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";for(;t.inputArrayToProcess.length<p;)t.inputArrayToProcess.push(null);t.inputArrayToProcess[p]={arrayName:d,fieldAssociation:m,attributeType:x}}}const mn=Symbol("Event abort");function ca(e,t,n){const r=[],a=e.delete;let i=1;function s(c){for(let f=0;f<r.length;++f){const[g]=r[f];if(g===c){r.splice(f,1);return}}}function u(c){function f(){s(c)}return Object.freeze({unsubscribe:f})}function o(){if(t.deleted){Z("instance deleted - cannot call any method");return}const c=r.slice();for(let f=0;f<c.length;++f){const[,g,y]=c[f];if(g){if(y<0)setTimeout(()=>g.apply(e,arguments),1-y);else if(g.apply(e,arguments)===mn)break}}}e[`invoke${q(n)}`]=o,e[`on${q(n)}`]=function(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!c.apply)return console.error(`Invalid callback for event ${n}`),null;if(t.deleted)return Z("instance deleted - cannot call any method"),null;const g=i++;return r.push([g,c,f]),r.sort((y,p)=>p[2]-y[2]),u(g)},e.delete=()=>{a(),r.forEach(c=>{let[f]=c;return s(f)})}}function xe(e,t){const n=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a={},i={};return e(i,a,r),Object.freeze(i)};return t&&dt.register(t,n),n}function fa(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t.filter(s=>!!s).map(s=>s(...a))}}function Tn(e){return e&&e.isA&&e.isA("vtkObject")}function De(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Tn(e)){if(r.indexOf(e)>=0)return n;r.push(e);const a=t(e);a!==void 0&&n.push(a);const i=e.get();Object.keys(i).forEach(s=>{const u=i[s];Array.isArray(u)?u.forEach(o=>{De(o,t,n,r)}):De(u,t,n,r)})}return n}function la(e,t,n){var r=this;let a;const i=function(){for(var s=arguments.length,u=new Array(s),o=0;o<s;o++)u[o]=arguments[o];const c=r,f=()=>{a=null,n||e.apply(c,u)},g=n&&!a;clearTimeout(a),a=setTimeout(f,t),g&&e.apply(c,u)};return i.cancel=()=>clearTimeout(a),i}function ga(e,t){let n=!1,r=null;function a(){n=!1,r!==null&&(i(...r),r=null)}function i(){for(var s=arguments.length,u=new Array(s),o=0;o<s;o++)u[o]=arguments[o];if(n){r=u;return}n=!0,e(...u),setTimeout(a,t)}return i}function wn(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};t.keystore=Object.assign(t.keystore||{},n),e.setKey=(r,a)=>{t.keystore[r]=a},e.getKey=r=>t.keystore[r],e.getAllKeys=()=>Object.keys(t.keystore),e.deleteKey=r=>delete t.keystore[r],e.clearKeystore=()=>e.getAllKeys().forEach(r=>delete t.keystore[r])}let Jo=1;const Ae="__root__";function ya(e,t){wn(e,t);const n=e.delete;t.proxyId=`${Jo++}`,t.ui=JSON.parse(JSON.stringify(t.ui||[])),re(e,t,["proxyId","proxyGroup","proxyName"]),Se(e,t,["proxyManager"]);const r={},a={};function i(c,f){a[f]||(a[f]=[]);const g=a[f];for(let y=0;y<c.length;y++)g.push(c[y].name),r[c[y].name]=c[y],c[y].children&&c[y].children.length&&i(c[y].children,c[y].name)}i(t.ui,Ae),e.updateUI=c=>{t.ui=JSON.parse(JSON.stringify(c||[])),Object.keys(r).forEach(f=>delete r[f]),Object.keys(a).forEach(f=>delete a[f]),i(t.ui,Ae),e.modified()};function s(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ae;return a[c]}e.updateProxyProperty=(c,f)=>{const g=r[c];g?Object.assign(g,f):r[c]={...f}},e.activate=()=>{if(t.proxyManager){const c=`setActive${q(e.getProxyGroup().slice(0,-1))}`;t.proxyManager[c]&&t.proxyManager[c](e)}},t.propertyLinkSubscribers={},e.registerPropertyLinkForGC=(c,f)=>{f in t.propertyLinkSubscribers||(t.propertyLinkSubscribers[f]=[]),t.propertyLinkSubscribers[f].push(c)},e.gcPropertyLinks=c=>{const f=t.propertyLinkSubscribers[c]||[];for(;f.length;)f.pop().unbind(e)},t.propertyLinkMap={},e.getPropertyLink=function(c){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.propertyLinkMap[c])return t.propertyLinkMap[c];let g=null;const y=[];let p=0,d=!1;function m(D){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(d)return null;const M=[];let b=null;for(p=y.length;p--;){const j=y[p];j.instance===D?b=j:M.push(j)}if(!b)return null;const k=b.instance[`get${q(b.propertyName)}`]();if(!Ko(k,g)||R){for(g=k,d=!0;M.length;){const j=M.pop();j.instance.set({[j.propertyName]:g})}d=!1}return t.propertyLinkMap[c].persistent&&(t.propertyLinkMap[c].value=k),k}function x(D,R){const M=[];for(p=y.length;p--;){const b=y[p];b.instance===D&&(b.propertyName===R||R===void 0)&&(b.subscription.unsubscribe(),M.push(p))}for(;M.length;)y.splice(M.pop(),1)}function L(D,R){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const b=D.onModified(m),k=y[0];return y.push({instance:D,propertyName:R,subscription:b}),M&&(t.propertyLinkMap[c].persistent&&t.propertyLinkMap[c].value!==void 0?D.set({[R]:t.propertyLinkMap[c].value}):k&&m(k.instance,!0)),{unsubscribe:()=>x(D,R)}}function A(){for(;y.length;)y.pop().subscription.unsubscribe()}const _={bind:L,unbind:x,unsubscribe:A,persistent:f};return t.propertyLinkMap[c]=_,_};function u(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ae;const f=[],g=t.proxyId,y=s(c)||[];for(let p=0;p<y.length;p++){const d=y[p],m=e[`get${q(d)}`],x=m?m():void 0,L={id:g,name:d,value:x},A=u(d);A.length&&(L.children=A),f.push(L)}return f}e.listPropertyNames=()=>u().map(c=>c.name),e.getPropertyByName=c=>u().find(f=>f.name===c),e.getPropertyDomainByName=c=>(r[c]||{}).domain,e.getProxySection=()=>({id:t.proxyId,name:t.proxyGroup,ui:t.ui,properties:u()}),e.delete=()=>{const c=Object.keys(t.propertyLinkMap);let f=c.length;for(;f--;)t.propertyLinkMap[c[f]].unsubscribe();Object.keys(t.propertyLinkSubscribers).forEach(e.gcPropertyLinks),n()},e.getState=()=>null;function o(){if(t.links)for(let c=0;c<t.links.length;c++){const{link:f,property:g,persistent:y,updateOnBind:p,type:d}=t.links[c];if(d==="application"){const m=t.proxyManager.getPropertyLink(f,y);e.registerPropertyLinkForGC(m,"application"),m.bind(e,g,p)}}}hn(o)}function ha(e,t,n){const r=e.delete,a=[],i=Object.keys(n);let s=i.length;for(;s--;){const u=i[s],{modelKey:o,property:c,modified:f=!0}=n[u],g=q(c),y=q(u);e[`get${y}`]=t[o][`get${g}`],e[`set${y}`]=t[o][`set${g}`],f&&a.push(t[o].onModified(e.modified))}e.delete=()=>{for(;a.length;)a.pop().unsubscribe();r()}}function pa(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};t.this=e;function a(u){const o=Object.keys(u);let c=o.length;for(;c--;){const f=o[c];t[f].set(u[f])}}const i=Object.keys(r);let s=i.length;for(;s--;){const u=i[s];t[u]=r[u];const o=n[u];e[`set${q(u)}`]=c=>{if(c!==t[u]){t[u]=c;const f=o[c];a(f),e.modified()}}}i.length&&re(e,t,i)}const va=10,da=40,ma=800;function Ta(e){let t=0,n=0,r=0,a=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),r=t*va,a=n*va,"deltaY"in e&&(a=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||a)&&e.deltaMode&&(e.deltaMode===1?(r*=da,a*=da):(r*=ma,a*=ma)),r&&!t&&(t=r<1?-1:1),a&&!n&&(n=a<1?-1:1),{spinX:t,spinY:n||t,pixelX:r,pixelY:a||r}}var G={algo:dn,capitalize:Ee,chain:fa,debounce:la,enumToString:Yo,event:ca,EVENT_ABORT:mn,formatBytesToProperUnit:ea,formatNumbersWithThousandSeparator:na,get:re,getArray:pn,getCurrentGlobalMTime:Wo,getStateArrayMapFunc:aa,isVtkObject:Tn,keystore:wn,measurePromiseExecution:ia,moveToProtected:ua,newInstance:xe,newTypedArray:we,newTypedArrayFrom:_e,normalizeWheel:Ta,obj:Ce,proxy:ya,proxyPropertyMapping:ha,proxyPropertyState:pa,safeArrays:ra,set:Oe,setArray:vn,setGet:Se,setGetArray:oa,setImmediate:hn,setLoggerFunction:Xr,throttle:ga,traverseInstanceTree:De,TYPED_ARRAYS:nt,uncapitalize:ta,VOID:Kr,vtkDebugMacro:Te,vtkErrorMacro:Z,vtkInfoMacro:Jr,vtkLogMacro:Qr,vtkOnceErrorMacro:Zr,vtkWarningMacro:yn},wa=Object.freeze({__proto__:null,VOID:Kr,setLoggerFunction:Xr,vtkLogMacro:Qr,vtkInfoMacro:Jr,vtkDebugMacro:Te,vtkErrorMacro:Z,vtkWarningMacro:yn,vtkOnceErrorMacro:Zr,TYPED_ARRAYS:nt,newTypedArray:we,newTypedArrayFrom:_e,capitalize:Ee,_capitalize:q,uncapitalize:ta,formatBytesToProperUnit:ea,formatNumbersWithThousandSeparator:na,setImmediateVTK:hn,measurePromiseExecution:ia,obj:Ce,get:re,set:Oe,setGet:Se,getArray:pn,setArray:vn,setGetArray:oa,moveToProtected:ua,algo:dn,EVENT_ABORT:mn,event:ca,newInstance:xe,chain:fa,isVtkObject:Tn,traverseInstanceTree:De,debounce:la,throttle:ga,keystore:wn,proxy:ya,proxyPropertyMapping:ha,proxyPropertyState:pa,normalizeWheel:Ta,default:G}),_n={exports:{}};_n.exports,function(e){(function(t,n,r){function a(o){var c=this,f=u();c.next=function(){var g=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=g-(c.c=g|0)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(o),c.s0<0&&(c.s0+=1),c.s1-=f(o),c.s1<0&&(c.s1+=1),c.s2-=f(o),c.s2<0&&(c.s2+=1),f=null}function i(o,c){return c.c=o.c,c.s0=o.s0,c.s1=o.s1,c.s2=o.s2,c}function s(o,c){var f=new a(o),g=c&&c.state,y=f.next;return y.int32=function(){return f.next()*4294967296|0},y.double=function(){return y()+(y()*2097152|0)*11102230246251565e-32},y.quick=y,g&&(typeof g=="object"&&i(g,f),y.state=function(){return i(f,{})}),y}function u(){var o=4022871197,c=function(f){f=String(f);for(var g=0;g<f.length;g++){o+=f.charCodeAt(g);var y=.02519603282416938*o;o=y>>>0,y-=o,y*=o,o=y>>>0,y-=o,o+=y*4294967296}return(o>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=s:this.alea=s})(yt,e)}(_n);var qo=_n.exports,En={exports:{}};En.exports,function(e){(function(t,n,r){function a(u){var o=this,c="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var g=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^g^g>>>8},u===(u|0)?o.x=u:c+=u;for(var f=0;f<c.length+64;f++)o.x^=c.charCodeAt(f)|0,o.next()}function i(u,o){return o.x=u.x,o.y=u.y,o.z=u.z,o.w=u.w,o}function s(u,o){var c=new a(u),f=o&&o.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var y=c.next()>>>11,p=(c.next()>>>0)/4294967296,d=(y+p)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(typeof f=="object"&&i(f,c),g.state=function(){return i(c,{})}),g}n&&n.exports?n.exports=s:this.xor128=s})(yt,e)}(En);var Zo=En.exports,Cn={exports:{}};Cn.exports,function(e){(function(t,n,r){function a(u){var o=this,c="";o.next=function(){var g=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(g^g<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,u===(u|0)?o.x=u:c+=u;for(var f=0;f<c.length+64;f++)o.x^=c.charCodeAt(f)|0,f==c.length&&(o.d=o.x<<10^o.x>>>4),o.next()}function i(u,o){return o.x=u.x,o.y=u.y,o.z=u.z,o.w=u.w,o.v=u.v,o.d=u.d,o}function s(u,o){var c=new a(u),f=o&&o.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var y=c.next()>>>11,p=(c.next()>>>0)/4294967296,d=(y+p)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(typeof f=="object"&&i(f,c),g.state=function(){return i(c,{})}),g}n&&n.exports?n.exports=s:this.xorwow=s})(yt,e)}(Cn);var tu=Cn.exports,On={exports:{}};On.exports,function(e){(function(t,n,r){function a(u){var o=this;o.next=function(){var f=o.x,g=o.i,y,p;return y=f[g],y^=y>>>7,p=y^y<<24,y=f[g+1&7],p^=y^y>>>10,y=f[g+3&7],p^=y^y>>>3,y=f[g+4&7],p^=y^y<<7,y=f[g+7&7],y=y^y<<13,p^=y^y<<9,f[g]=p,o.i=g+1&7,p};function c(f,g){var y,p=[];if(g===(g|0))p[0]=g;else for(g=""+g,y=0;y<g.length;++y)p[y&7]=p[y&7]<<15^g.charCodeAt(y)+p[y+1&7]<<13;for(;p.length<8;)p.push(0);for(y=0;y<8&&p[y]===0;++y);for(y==8?p[7]=-1:p[y],f.x=p,f.i=0,y=256;y>0;--y)f.next()}c(o,u)}function i(u,o){return o.x=u.x.slice(),o.i=u.i,o}function s(u,o){u==null&&(u=+new Date);var c=new a(u),f=o&&o.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var y=c.next()>>>11,p=(c.next()>>>0)/4294967296,d=(y+p)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(f.x&&i(f,c),g.state=function(){return i(c,{})}),g}n&&n.exports?n.exports=s:this.xorshift7=s})(yt,e)}(On);var eu=On.exports,Sn={exports:{}};Sn.exports,function(e){(function(t,n,r){function a(u){var o=this;o.next=function(){var f=o.w,g=o.X,y=o.i,p,d;return o.w=f=f+1640531527|0,d=g[y+34&127],p=g[y=y+1&127],d^=d<<13,p^=p<<17,d^=d>>>15,p^=p>>>12,d=g[y]=d^p,o.i=y,d+(f^f>>>16)|0};function c(f,g){var y,p,d,m,x,L=[],A=128;for(g===(g|0)?(p=g,g=null):(g=g+"\0",p=0,A=Math.max(A,g.length)),d=0,m=-32;m<A;++m)g&&(p^=g.charCodeAt((m+32)%g.length)),m===0&&(x=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,m>=0&&(x=x+1640531527|0,y=L[m&127]^=p+x,d=y==0?d+1:0);for(d>=128&&(L[(g&&g.length||0)&127]=-1),d=127,m=4*128;m>0;--m)p=L[d+34&127],y=L[d=d+1&127],p^=p<<13,y^=y<<17,p^=p>>>15,y^=y>>>12,L[d]=p^y;f.w=x,f.X=L,f.i=d}c(o,u)}function i(u,o){return o.i=u.i,o.w=u.w,o.X=u.X.slice(),o}function s(u,o){u==null&&(u=+new Date);var c=new a(u),f=o&&o.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var y=c.next()>>>11,p=(c.next()>>>0)/4294967296,d=(y+p)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(f.X&&i(f,c),g.state=function(){return i(c,{})}),g}n&&n.exports?n.exports=s:this.xor4096=s})(yt,e)}(Sn);var nu=Sn.exports,xn={exports:{}};xn.exports,function(e){(function(t,n,r){function a(u){var o=this,c="";o.next=function(){var g=o.b,y=o.c,p=o.d,d=o.a;return g=g<<25^g>>>7^y,y=y-p|0,p=p<<24^p>>>8^d,d=d-g|0,o.b=g=g<<20^g>>>12^y,o.c=y=y-p|0,o.d=p<<16^y>>>16^d,o.a=d-g|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,u===Math.floor(u)?(o.a=u/4294967296|0,o.b=u|0):c+=u;for(var f=0;f<c.length+20;f++)o.b^=c.charCodeAt(f)|0,o.next()}function i(u,o){return o.a=u.a,o.b=u.b,o.c=u.c,o.d=u.d,o}function s(u,o){var c=new a(u),f=o&&o.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var y=c.next()>>>11,p=(c.next()>>>0)/4294967296,d=(y+p)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(typeof f=="object"&&i(f,c),g.state=function(){return i(c,{})}),g}n&&n.exports?n.exports=s:this.tychei=s})(yt,e)}(xn);var ru=xn.exports,_a={exports:{}},au={},iu=Object.freeze({__proto__:null,default:au}),su=Ms(iu);(function(e){(function(t,n,r){var a=256,i=6,s=52,u="random",o=r.pow(a,i),c=r.pow(2,s),f=c*2,g=a-1,y;function p(D,R,M){var b=[];R=R==!0?{entropy:!0}:R||{};var k=L(x(R.entropy?[D,_(n)]:D??A(),3),b),j=new d(b),$=function(){for(var F=j.g(i),V=o,H=0;F<c;)F=(F+H)*a,V*=a,H=j.g(1);for(;F>=f;)F/=2,V/=2,H>>>=1;return(F+H)/V};return $.int32=function(){return j.g(4)|0},$.quick=function(){return j.g(4)/4294967296},$.double=$,L(_(j.S),n),(R.pass||M||function(F,V,H,U){return U&&(U.S&&m(U,j),F.state=function(){return m(j,{})}),H?(r[u]=F,V):F})($,k,"global"in R?R.global:this==r,R.state)}function d(D){var R,M=D.length,b=this,k=0,j=b.i=b.j=0,$=b.S=[];for(M||(D=[M++]);k<a;)$[k]=k++;for(k=0;k<a;k++)$[k]=$[j=g&j+D[k%M]+(R=$[k])],$[j]=R;(b.g=function(F){for(var V,H=0,U=b.i,z=b.j,P=b.S;F--;)V=P[U=g&U+1],H=H*a+P[g&(P[U]=P[z=g&z+V])+(P[z]=V)];return b.i=U,b.j=z,H})(a)}function m(D,R){return R.i=D.i,R.j=D.j,R.S=D.S.slice(),R}function x(D,R){var M=[],b=typeof D,k;if(R&&b=="object")for(k in D)try{M.push(x(D[k],R-1))}catch{}return M.length?M:b=="string"?D:D+"\0"}function L(D,R){for(var M=D+"",b,k=0;k<M.length;)R[g&k]=g&(b^=R[g&k]*19)+M.charCodeAt(k++);return _(R)}function A(){try{var D;return y&&(D=y.randomBytes)?D=D(a):(D=new Uint8Array(a),(t.crypto||t.msCrypto).getRandomValues(D)),_(D)}catch{var R=t.navigator,M=R&&R.plugins;return[+new Date,t,M,t.screen,_(n)]}}function _(D){return String.fromCharCode.apply(0,D)}if(L(r.random(),n),e.exports){e.exports=p;try{y=su}catch{}}else r["seed"+u]=p})(typeof self<"u"?self:yt,[],Math)})(_a);var ou=_a.exports,uu=qo,cu=Zo,fu=tu,lu=eu,gu=nu,yu=ru,qt=ou;qt.alea=uu,qt.xor128=cu,qt.xorwow=fu,qt.xorshift7=lu,qt.xor4096=gu,qt.tychei=yu;const hu=1e-12,{vtkErrorMacro:sg,vtkWarningMacro:Ea}=G;function Dn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;const t=Array(e);for(let n=0;n<e;++n)t[n]=0;return t}function pu(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function bt(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function Ca(e,t,n,r){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r}function X(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Oa(e,t,n){const r=e[1]*t[2]-e[2]*t[1],a=e[2]*t[0]-e[0]*t[2],i=e[0]*t[1]-e[1]*t[0];return n[0]=r,n[1]=a,n[2]=i,n}function Sa(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(t){case 1:return Math.abs(e);case 2:return Math.sqrt(e[0]*e[0]+e[1]*e[1]);case 3:return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);default:{let n=0;for(let r=0;r<t;r++)n+=e[r]*e[r];return Math.sqrt(n)}}}function vu(e){const t=Sa(e);return t!==0&&(e[0]/=t,e[1]/=t,e[2]/=t),t}function St(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])+(e[2]-t[2])*(e[2]-t[2])}function Me(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.length===2?t[0][0]*t[1][1]-t[1][0]*t[0][1]:t.length===4?t[0]*t[3]-t[1]*t[2]:Number.NaN}function An(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!`${e}`.includes("e"))return+`${Math.round(`${e}e+${t}`)}e-${t}`;const n=`${e}`.split("e");let r="";return+n[1]+t>0&&(r="+"),+`${Math.round(`${+n[0]}e${r}${+n[1]+t}`)}e-${t}`}function xa(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return t[0]=An(e[0],n),t[1]=An(e[1],n),t[2]=An(e[2],n),t}function du(e,t,n){let r,a,i,s,u=0,o,c,f;const g=Dn(n);for(r=0;r<n;r++){for(s=0,a=0;a<n;a++)(f=Math.abs(e[r*n+a]))>s&&(s=f);if(s===0)return Ea("Unable to factor linear system"),0;g[r]=1/s}for(a=0;a<n;a++){for(r=0;r<a;r++){for(o=e[r*n+a],i=0;i<r;i++)o-=e[r*n+i]*e[i*n+a];e[r*n+a]=o}for(s=0,r=a;r<n;r++){for(o=e[r*n+a],i=0;i<a;i++)o-=e[r*n+i]*e[i*n+a];e[r*n+a]=o,(c=g[r]*Math.abs(o))>=s&&(s=c,u=r)}if(a!==u){for(i=0;i<n;i++)c=e[u*n+i],e[u*n+i]=e[a*n+i],e[a*n+i]=c;g[u]=g[a]}if(t[a]=u,Math.abs(e[a*n+a])<=hu)return Ea("Unable to factor linear system"),0;if(a!==n-1)for(c=1/e[a*n+a],r=a+1;r<n;r++)e[r*n+a]*=c}return 1}function mu(e,t,n,r){let a,i,s,u,o;for(s=-1,a=0;a<r;a++){if(u=t[a],o=n[u],n[u]=n[a],s>=0)for(i=s;i<=a-1;i++)o-=e[a*r+i]*n[i];else o!==0&&(s=a);n[a]=o}for(a=r-1;a>=0;a--){for(o=n[a],i=a+1;i<r;i++)o-=e[a*r+i]*n[i];n[a]=o/e[a*r+a]}}function Tu(e,t,n){if(n===2){const a=Dn(2),i=Me(e[0],e[1],e[2],e[3]);return i===0?0:(a[0]=(e[3]*t[0]-e[1]*t[1])/i,a[1]=(-(e[2]*t[0])+e[0]*t[1])/i,t[0]=a[0],t[1]=a[1],1)}if(n===1)return e[0]===0?0:(t[0]/=e[0],1);const r=Dn(n);return du(e,r,n)===0?0:(mu(e,r,t,n),1)}function wu(e){return e[0]=1,e[1]=-1,e[2]=1,e[3]=-1,e[4]=1,e[5]=-1,e}function Mn(e,t,n){return e<t?t:e>n?n:e}function Da(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return r[0]=Mn(e[0],t[0],n[0]),r[1]=Mn(e[1],t[1],n[1]),r[2]=Mn(e[2],t[2],n[2]),r}var Aa=1e-6,Et=typeof Float32Array<"u"?Float32Array:Array;function _u(e,t){return Math.abs(e-t)<=Aa*Math.max(1,Math.abs(e),Math.abs(t))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function Eu(){var e=new Et(9);return Et!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Cu(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ou(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],s=t[4],u=t[5],o=t[6],c=t[7],f=t[8],g=t[9],y=t[10],p=t[11],d=t[12],m=t[13],x=t[14],L=t[15],A=n*u-r*s,_=n*o-a*s,D=n*c-i*s,R=r*o-a*u,M=r*c-i*u,b=a*c-i*o,k=f*m-g*d,j=f*x-y*d,$=f*L-p*d,F=g*x-y*m,V=g*L-p*m,H=y*L-p*x,U=A*H-_*V+D*F+R*$-M*j+b*k;return U?(U=1/U,e[0]=(u*H-o*V+c*F)*U,e[1]=(a*V-r*H-i*F)*U,e[2]=(m*b-x*M+L*R)*U,e[3]=(y*M-g*b-p*R)*U,e[4]=(o*$-s*H-c*j)*U,e[5]=(n*H-a*$+i*j)*U,e[6]=(x*D-d*b-L*_)*U,e[7]=(f*b-y*D+p*_)*U,e[8]=(s*V-u*$+c*k)*U,e[9]=(r*$-n*V-i*k)*U,e[10]=(d*M-m*D+L*A)*U,e[11]=(g*D-f*M-p*A)*U,e[12]=(u*j-s*F-o*k)*U,e[13]=(n*F-r*j+a*k)*U,e[14]=(m*_-d*R-x*A)*U,e[15]=(f*R-g*_+y*A)*U,e):null}function Su(e,t,n){var r=n[0],a=n[1],i=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function xu(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Ma(){var e=new Et(3);return Et!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function kn(e){var t=new Et(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Du(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function rt(e,t,n){var r=new Et(3);return r[0]=e,r[1]=t,r[2]=n,r}function ka(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ln(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Au(e,t){var n=t[0],r=t[1],a=t[2],i=n*n+r*r+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function Nn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Rn(e,t,n){var r=t[0],a=t[1],i=t[2],s=n[0],u=n[1],o=n[2];return e[0]=a*o-i*u,e[1]=i*s-r*o,e[2]=r*u-a*s,e}function bn(e,t,n){var r=t[0],a=t[1],i=t[2],s=n[3]*r+n[7]*a+n[11]*i+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*a+n[8]*i+n[12])/s,e[1]=(n[1]*r+n[5]*a+n[9]*i+n[13])/s,e[2]=(n[2]*r+n[6]*a+n[10]*i+n[14])/s,e}var Mu=Du;(function(){var e=Ma();return function(t,n,r,a,i,s){var u,o;for(n||(n=3),r||(r=0),a?o=Math.min(a*n+r,t.length):o=t.length,u=r;u<o;u+=n)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],i(e,e,s),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2];return t}})();function ku(){var e=new Et(4);return Et!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Lu(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],s=n*n+r*r+a*a+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=r*s,e[2]=a*s,e[3]=i*s,e}(function(){var e=ku();return function(t,n,r,a,i,s){var u,o;for(n||(n=4),r||(r=0),a?o=Math.min(a*n+r,t.length):o=t.length,u=r;u<o;u+=n)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],i(e,e,s),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}})();function La(){var e=new Et(4);return Et!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Nu(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function ke(e,t,n,r){var a=t[0],i=t[1],s=t[2],u=t[3],o=n[0],c=n[1],f=n[2],g=n[3],y,p,d,m,x;return p=a*o+i*c+s*f+u*g,p<0&&(p=-p,o=-o,c=-c,f=-f,g=-g),1-p>Aa?(y=Math.acos(p),d=Math.sin(y),m=Math.sin((1-r)*y)/d,x=Math.sin(r*y)/d):(m=1-r,x=r),e[0]=m*a+x*o,e[1]=m*i+x*c,e[2]=m*s+x*f,e[3]=m*u+x*g,e}function Ru(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[a*3+a]&&(a=2);var i=(a+1)%3,s=(a+2)%3;r=Math.sqrt(t[a*3+a]-t[i*3+i]-t[s*3+s]+1),e[a]=.5*r,r=.5/r,e[3]=(t[i*3+s]-t[s*3+i])*r,e[i]=(t[i*3+a]+t[a*3+i])*r,e[s]=(t[s*3+a]+t[a*3+s])*r}return e}var Na=Lu;(function(){var e=Ma(),t=rt(1,0,0),n=rt(0,1,0);return function(r,a,i){var s=Nn(a,i);return s<-.999999?(Rn(e,t,a),Mu(e)<1e-6&&Rn(e,n,a),Au(e,e),Nu(r,e,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Rn(e,a,i),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+s,Na(r,r))}})(),function(){var e=La(),t=La();return function(n,r,a,i,s,u){return ke(e,r,s,u),ke(t,a,i,u),ke(n,e,t,2*u*(1-u)),n}}(),function(){var e=Eu();return function(t,n,r,a){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Na(t,Ru(t,e))}}();const In=1e-6,Ra="coincide",ba="disjoint";function bu(e,t,n){return e[0]*(n[0]-t[0])+e[1]*(n[1]-t[1])+e[2]*(n[2]-t[2])}function Ia(e,t,n){const r=n[0]*(e[0]-t[0])+n[1]*(e[1]-t[1])+n[2]*(e[2]-t[2]);return Math.abs(r)}function Fa(e,t,n,r){const a=[];bt(e,t,a);const i=X(n,a);r[0]=e[0]-i*n[0],r[1]=e[1]-i*n[1],r[2]=e[2]-i*n[2]}function $a(e,t,n){const r=X(e,t);let a=X(t,t);return a===0&&(a=1),n[0]=e[0]-r*t[0]/a,n[1]=e[1]-r*t[1]/a,n[2]=e[2]-r*t[2]/a,n}function Va(e,t,n,r){const a=[];bt(e,t,a);const i=X(n,a),s=X(n,n);s!==0?(r[0]=e[0]-i*n[0]/s,r[1]=e[1]-i*n[1]/s,r[2]=e[2]-i*n[2]/s):(r[0]=e[0],r[1]=e[1],r[2]=e[2])}function Ua(e,t,n,r){const a={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},i=[],s=[];bt(t,e,i),bt(n,e,s);const u=X(r,s),o=X(r,i);let c,f;return o<0?c=-o:c=o,u<0?f=-u*In:f=u*In,c<=f||(a.t=u/o,a.x[0]=e[0]+a.t*i[0],a.x[1]=e[1]+a.t*i[1],a.x[2]=e[2]+a.t*i[2],a.intersection=!0,a.betweenPoints=a.t>=0&&a.t<=1),a}function ja(e,t,n,r){const a={intersection:!1,l0:[],l1:[],error:null},i=[];Oa(t,r,i);const s=i.map(g=>Math.abs(g));if(s[0]+s[1]+s[2]<In){const g=[];return bt(e,n,g),X(t,g)===0?a.error=Ra:a.error=ba,a}let u;s[0]>s[1]&&s[0]>s[2]?u="x":s[1]>s[2]?u="y":u="z";const o=[],c=-X(t,e),f=-X(r,n);switch(u){case"x":o[0]=0,o[1]=(f*t[2]-c*r[2])/i[0],o[2]=(c*r[1]-f*t[1])/i[0];break;case"y":o[0]=(c*r[2]-f*t[2])/i[1],o[1]=0,o[2]=(f*t[0]-c*r[0])/i[1];break;case"z":o[0]=(f*t[1]-c*r[1])/i[2],o[1]=(c*r[0]-f*t[0])/i[2],o[2]=0;break}return a.l0=o,pu(o,i,a.l1),a.intersection=!0,a}const Iu={evaluate:bu,distanceToPlane:Ia,projectPoint:Fa,projectVector:$a,generalizedProjectPoint:Va,intersectWithLine:Ua,intersectWithPlane:ja,DISJOINT:ba,COINCIDE:Ra};function Fu(e,t){t.classHierarchy.push("vtkPlane"),e.distanceToPlane=n=>Ia(n,t.origin,t.normal),e.projectPoint=(n,r)=>{Fa(n,t.origin,t.normal,r)},e.projectVector=(n,r)=>$a(n,t.normal,r),e.push=n=>{if(n!==0)for(let r=0;r<3;r++)t.origin[r]+=n*t.normal[r]},e.generalizedProjectPoint=(n,r)=>{Va(n,t.origin,t.normal,r)},e.evaluateFunction=(n,r,a)=>Array.isArray(n)?t.normal[0]*(n[0]-t.origin[0])+t.normal[1]*(n[1]-t.origin[1])+t.normal[2]*(n[2]-t.origin[2]):t.normal[0]*(n-t.origin[0])+t.normal[1]*(r-t.origin[1])+t.normal[2]*(a-t.origin[2]),e.evaluateGradient=n=>[t.normal[0],t.normal[1],t.normal[2]],e.intersectWithLine=(n,r)=>Ua(n,r,t.origin,t.normal),e.intersectWithPlane=(n,r)=>ja(n,r,t.origin,t.normal)}const $u={normal:[0,0,1],origin:[0,0,0]};function Pa(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,$u,n),G.obj(e,t),G.setGetArray(e,t,["normal","origin"],3),Fu(e,t)}var jt={newInstance:G.newInstance(Pa,"vtkPlane"),extend:Pa,...Iu};const Le=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function za(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function xt(e){return(e==null?void 0:e.length)>=6&&e[0]<=e[1]&&e[2]<=e[3]&&e[4]<=e[5]}function Fn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function $n(e){return Fn(e,Le)}function Ne(e,t,n,r){const[a,i,s,u,o,c]=e;return e[0]=a<t?a:t,e[1]=i>t?i:t,e[2]=s<n?s:n,e[3]=u>n?u:n,e[4]=o<r?o:r,e[5]=c>r?c:r,e}function Vn(e,t){if(t.length===0)return e;if(Array.isArray(t[0]))for(let n=0;n<t.length;++n)Ne(e,...t[n]);else for(let n=0;n<t.length;n+=3)Ne(e,...t.slice(n,n+3));return e}function Ha(e,t,n,r,a,i,s){const[u,o,c,f,g,y]=e;return s===void 0?(e[0]=Math.min(t[0],u),e[1]=Math.max(t[1],o),e[2]=Math.min(t[2],c),e[3]=Math.max(t[3],f),e[4]=Math.min(t[4],g),e[5]=Math.max(t[5],y)):(e[0]=Math.min(t,u),e[1]=Math.max(n,o),e[2]=Math.min(r,c),e[3]=Math.max(a,f),e[4]=Math.min(i,g),e[5]=Math.max(s,y)),e}function Ga(e,t,n,r){const[a,i,s,u,o,c]=e;return e[0]=t,e[1]=t>i?t:i,e[2]=n,e[3]=n>u?n:u,e[4]=r,e[5]=r>c?r:c,a!==t||s!==n||o!==r}function Wa(e,t,n,r){const[a,i,s,u,o,c]=e;return e[0]=t<a?t:a,e[1]=t,e[2]=n<s?n:s,e[3]=n,e[4]=r<o?r:o,e[5]=r,i!==t||u!==n||c!==r}function Ba(e,t){return e[0]-=t,e[1]+=t,e[2]-=t,e[3]+=t,e[4]-=t,e[5]+=t,e}function Un(e,t,n,r){return xt(e)?(t>=0?(e[0]*=t,e[1]*=t):(e[0]=t*e[1],e[1]=t*e[0]),n>=0?(e[2]*=n,e[3]*=n):(e[2]=n*e[3],e[3]=n*e[2]),r>=0?(e[4]*=r,e[5]*=r):(e[4]=r*e[5],e[5]=r*e[4]),!0):!1}function jn(e){return[.5*(e[0]+e[1]),.5*(e[2]+e[3]),.5*(e[4]+e[5])]}function Vu(e,t,n,r){if(!xt(e))return!1;const a=jn(e);return e[0]-=a[0],e[1]-=a[0],e[2]-=a[1],e[3]-=a[1],e[4]-=a[2],e[5]-=a[2],Un(e,t,n,r),e[0]+=a[0],e[1]+=a[0],e[2]+=a[1],e[3]+=a[1],e[4]+=a[2],e[5]+=a[2],!0}function ae(e,t){return e[t*2+1]-e[t*2]}function Re(e){return[ae(e,0),ae(e,1),ae(e,2)]}function Ka(e){return e.slice(0,2)}function Ya(e){return e.slice(2,4)}function Xa(e){return e.slice(4,6)}function Qa(e){const t=Re(e);return t[0]>t[1]?t[0]>t[2]?t[0]:t[2]:t[1]>t[2]?t[1]:t[2]}function Ja(e){if(xt(e)){const t=Re(e);return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}return null}function Pn(e){return[e[0],e[2],e[4]]}function zn(e){return[e[1],e[3],e[5]]}function be(e,t){return e<=0&&t>=0||e>=0&&t<=0}function Hn(e,t){let n=0;for(let r=0;r<2;r++)for(let a=2;a<4;a++)for(let i=4;i<6;i++)t[n++]=[e[r],e[a],e[i]];return t}function qa(e,t,n){return t[0]=e[0],t[1]=e[2],t[2]=e[4],n[0]=e[1],n[1]=e[3],n[2]=e[5],t}function Za(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const r=Hn(e,[]);for(let a=0;a<r.length;++a)bn(r[a],r[a],t);return $n(n),Vn(n,r)}function ti(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t[0]=.5*(e[1]-e[0]),t[1]=.5*(e[3]-e[2]),t[2]=.5*(e[5]-e[4]),t}function ei(e,t,n,r){const a=[].concat(Le),i=e.getData();for(let s=0;s<i.length;s+=3){const u=[i[s],i[s+1],i[s+2]],o=X(u,t);a[0]=Math.min(o,a[0]),a[1]=Math.max(o,a[1]);const c=X(u,n);a[2]=Math.min(c,a[2]),a[3]=Math.max(c,a[3]);const f=X(u,r);a[4]=Math.min(f,a[4]),a[5]=Math.max(f,a[5])}return a}function ni(e,t,n,r,a){let i=!0;const s=[];let u=0;const o=[],c=[0,0,0],f=0,g=1,y=2;for(let p=0;p<3;p++)t[p]<e[2*p]?(s[p]=g,c[p]=e[2*p],i=!1):t[p]>e[2*p+1]?(s[p]=f,c[p]=e[2*p+1],i=!1):s[p]=y;if(i)return r[0]=t[0],r[1]=t[1],r[2]=t[2],a[0]=0,1;for(let p=0;p<3;p++)s[p]!==y&&n[p]!==0?o[p]=(c[p]-t[p])/n[p]:o[p]=-1;for(let p=0;p<3;p++)o[u]<o[p]&&(u=p);if(o[u]>1||o[u]<0)return 0;a[0]=o[u];for(let p=0;p<3;p++)if(u!==p){if(r[p]=t[p]+o[u]*n[p],r[p]<e[2*p]||r[p]>e[2*p+1])return 0}else r[p]=c[p];return 1}function ri(e,t,n){const r=[];let a=0,i=1,s=1;for(let u=4;u<=5;++u){r[2]=e[u];for(let o=2;o<=3;++o){r[1]=e[o];for(let c=0;c<=1;++c)if(r[0]=e[c],a=jt.evaluate(n,t,r),s&&(i=a>=0?1:-1,s=0),a===0||i>0&&a<0||i<0&&a>0)return 1}}return 0}function ai(e,t){if(!(xt(e)&&xt(t)))return!1;const n=[0,0,0,0,0,0];let r;for(let a=0;a<3;a++)if(r=!1,t[a*2]>=e[a*2]&&t[a*2]<=e[a*2+1]?(r=!0,n[a*2]=t[a*2]):e[a*2]>=t[a*2]&&e[a*2]<=t[a*2+1]&&(r=!0,n[a*2]=e[a*2]),t[a*2+1]>=e[a*2]&&t[a*2+1]<=e[a*2+1]?(r=!0,n[a*2+1]=t[2*a+1]):e[a*2+1]>=t[a*2]&&e[a*2+1]<=t[a*2+1]&&(r=!0,n[a*2+1]=e[a*2+1]),!r)return!1;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],!0}function Ie(e,t){if(!(xt(e)&&xt(t)))return!1;for(let n=0;n<3;n++)if(!(t[n*2]>=e[n*2]&&t[n*2]<=e[n*2+1])&&!(e[n*2]>=t[n*2]&&e[n*2]<=t[n*2+1])&&!(t[n*2+1]>=e[n*2]&&t[n*2+1]<=e[n*2+1])&&!(e[n*2+1]>=t[n*2]&&e[n*2+1]<=t[n*2+1]))return!1;return!0}function Fe(e,t,n,r){return!(t<e[0]||t>e[1]||n<e[2]||n>e[3]||r<e[4]||r>e[5])}function Uu(e,t){return!(!Ie(e,t)||!Fe(e,...Pn(t))||!Fe(e,...zn(t)))}function ii(e,t,n){const r=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],a=[0,0,0,0,0,0,0,0];let i=0;for(let g=0;g<2;g++)for(let y=2;y<4;y++)for(let p=4;p<6;p++){const d=[e[g],e[y],e[p]];a[i++]=jt.evaluate(n,t,d)}let s=2;for(;s--&&!(be(a[r[s][0]],a[r[s][4]])&&be(a[r[s][1]],a[r[s][5]])&&be(a[r[s][2]],a[r[s][6]])&&be(a[r[s][3]],a[r[s][7]])););if(s<0)return!1;const u=Math.sign(n[s]),o=Math.abs((e[s*2+1]-e[s*2])*n[s]);let c=u>0?1:0;for(let g=0;g<4;g++){if(o===0)continue;const y=Math.abs(a[r[s][g]])/o;u>0&&y<c&&(c=y),u<0&&y>c&&(c=y)}const f=(1-c)*e[s*2]+c*e[s*2+1];return u>0?e[s*2]=f:e[s*2+1]=f,!0}class ju{constructor(t){this.bounds=t,this.bounds||(this.bounds=new Float64Array(Le))}getBounds(){return this.bounds}equals(t){return za(this.bounds,t)}isValid(){return xt(this.bounds)}setBounds(t){return Fn(this.bounds,t)}reset(){return $n(this.bounds)}addPoint(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ne(this.bounds,...n)}addPoints(t){return Vn(this.bounds,t)}addBounds(t,n,r,a,i,s){return Ha(this.bounds,t,n,r,a,i,s)}setMinPoint(t,n,r){return Ga(this.bounds,t,n,r)}setMaxPoint(t,n,r){return Wa(this.bounds,t,n,r)}inflate(t){return Ba(this.bounds,t)}scale(t,n,r){return Un(this.bounds,t,n,r)}getCenter(){return jn(this.bounds)}getLength(t){return ae(this.bounds,t)}getLengths(){return Re(this.bounds)}getMaxLength(){return Qa(this.bounds)}getDiagonalLength(){return Ja(this.bounds)}getMinPoint(){return Pn(this.bounds)}getMaxPoint(){return zn(this.bounds)}getXRange(){return Ka(this.bounds)}getYRange(){return Ya(this.bounds)}getZRange(){return Xa(this.bounds)}getCorners(t){return Hn(this.bounds,t)}computeCornerPoints(t,n){return qa(this.bounds,t,n)}computeLocalBounds(t,n,r){return ei(this.bounds,t,n,r)}transformBounds(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Za(this.bounds,t,n)}computeScale3(t){return ti(this.bounds,t)}cutWithPlane(t,n){return ii(this.bounds,t,n)}intersectBox(t,n,r,a){return ni(this.bounds,t,n,r,a)}intersectPlane(t,n){return ri(this.bounds,t,n)}intersect(t){return ai(this.bounds,t)}intersects(t){return Ie(this.bounds,t)}containsPoint(t,n,r){return Fe(this.bounds,t,n,r)}contains(t){return Ie(this.bounds,t)}}function Pu(e){const t=e&&e.bounds;return new ju(t)}var Zt={newInstance:Pu,...{equals:za,isValid:xt,setBounds:Fn,reset:$n,addPoint:Ne,addPoints:Vn,addBounds:Ha,setMinPoint:Ga,setMaxPoint:Wa,inflate:Ba,scale:Un,scaleAboutCenter:Vu,getCenter:jn,getLength:ae,getLengths:Re,getMaxLength:Qa,getDiagonalLength:Ja,getMinPoint:Pn,getMaxPoint:zn,getXRange:Ka,getYRange:Ya,getZRange:Xa,getCorners:Hn,computeCornerPoints:qa,computeLocalBounds:ei,transformBounds:Za,computeScale3:ti,cutWithPlane:ii,intersectBox:ni,intersectPlane:ri,intersect:ai,intersects:Ie,containsPoint:Fe,contains:Uu,INIT_BOUNDS:Le}};const zu={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},$e={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"};var si={DefaultDataType:$e.FLOAT,DataTypeByteSize:zu,VtkDataTypes:$e};const{vtkErrorMacro:Hu}=wa,{DefaultDataType:Gu}=si,Wu=1e-6;function Gn(e,t,n){const r=e.length;let a=Number.MAX_VALUE,i=-Number.MAX_VALUE,s,u;for(u=t;u<r;u+=n)if(!Number.isNaN(e[u])){a=e[u],i=a;break}for(;u<r;u+=n)s=e[u],s<a?a=s:s>i&&(i=s);return{min:a,max:i}}function Bu(){let e=Number.MAX_VALUE,t=-Number.MAX_VALUE,n=0,r=0;return{add(a){e>a&&(e=a),t<a&&(t=a),n++,r+=a},get(){return{min:e,max:t,count:n,sum:r,mean:r/n}},getRange(){return{min:e,max:t}}}}function oi(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(t<0&&n>1){const a=e.length/n,i=new Float64Array(a);for(let s=0,u=0;s<a;++s){for(let o=u+n;u<o;++u)i[s]+=e[u]*e[u];i[s]**=.5}return Gn(i,0,1)}return Gn(e,t<0?0:t,n)}function ui(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=e||[];for(;n.length<=t;)n.push(null);return n}function Wn(e){return Object.prototype.toString.call(e).slice(8,-1)}function Ku(e){const t=e.getNumberOfComponents();let n=0;const r=new Array(t);for(let a=0;a<e.getNumberOfTuples();++a){e.getTuple(a,r);const i=Sa(r,t);i>n&&(n=i)}return n}const Yu={computeRange:oi,createRangeHelper:Bu,fastComputeRange:Gn,getDataType:Wn,getMaxNorm:Ku};function Xu(e,t){t.classHierarchy.push("vtkDataArray");function n(r){if(r<0)return!1;const a=e.getNumberOfComponents(),i=t.values.length/(a>0?a:1);if(r===i)return!0;if(r>i){const s=t.values;return t.values=we(t.dataType,(r+i)*a),t.values.set(s),!0}return t.size>r*a&&(t.size=r*a,e.dataChange()),!0}e.dataChange=()=>{t.ranges=null,e.modified()},e.resize=r=>{n(r);const a=r*e.getNumberOfComponents();return t.size!==a?(t.size=a,e.dataChange(),!0):!1},e.initialize=()=>{e.resize(0)},e.getElementComponentSize=()=>t.values.BYTES_PER_ELEMENT,e.getComponent=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.values[r*t.numberOfComponents+a]},e.setComponent=(r,a,i)=>{i!==t.values[r*t.numberOfComponents+a]&&(t.values[r*t.numberOfComponents+a]=i,e.dataChange())},e.getValue=r=>{const a=r/t.numberOfComponents,i=r%t.numberOfComponents;return e.getComponent(a,i)},e.setValue=(r,a)=>{const i=r/t.numberOfComponents,s=r%t.numberOfComponents;e.setComponent(i,s,a)},e.getData=()=>t.size===t.values.length?t.values:t.values.subarray(0,t.size),e.getRange=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,a=r;a<0&&(a=t.numberOfComponents===1?0:t.numberOfComponents);let i=null;return t.ranges||(t.ranges=ui(t.ranges,t.numberOfComponents)),i=t.ranges[a],i?(t.rangeTuple[0]=i.min,t.rangeTuple[1]=i.max,t.rangeTuple):(i=oi(e.getData(),r,t.numberOfComponents),t.ranges[a]=i,t.rangeTuple[0]=i.min,t.rangeTuple[1]=i.max,t.rangeTuple)},e.setRange=(r,a)=>{t.ranges||(t.ranges=ui(t.ranges,t.numberOfComponents));const i={min:r.min,max:r.max};return t.ranges[a]=i,t.rangeTuple[0]=i.min,t.rangeTuple[1]=i.max,t.rangeTuple},e.setTuple=(r,a)=>{const i=r*t.numberOfComponents;for(let s=0;s<t.numberOfComponents;s++)t.values[i+s]=a[s]},e.setTuples=(r,a)=>{let i=r*t.numberOfComponents;const s=Math.min(a.length,t.size-i);for(let u=0;u<s;)t.values[i++]=a[u++]},e.insertTuple=(r,a)=>(t.size<=r*t.numberOfComponents&&(t.size=(r+1)*t.numberOfComponents,n(r+1)),e.setTuple(r,a),r),e.insertTuples=(r,a)=>{const i=r+a.length/t.numberOfComponents;return t.size<i*t.numberOfComponents&&(t.size=i*t.numberOfComponents,n(i)),e.setTuples(r,a),i},e.insertNextTuple=r=>{const a=t.size/t.numberOfComponents;return e.insertTuple(a,r)},e.insertNextTuples=r=>{const a=t.size/t.numberOfComponents;return e.insertTuples(a,r)},e.findTuple=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wu;for(let i=0;i<t.size;i+=t.numberOfComponents)if(Math.abs(r[0]-t.values[i])<=a){let s=!0;for(let u=1;u<t.numberOfComponents;++u)if(Math.abs(r[u]-t.values[i+u])>a){s=!1;break}if(s)return i/t.numberOfComponents}return-1},e.getTuple=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=t.numberOfComponents||1,s=r*i;switch(i){case 4:a[3]=t.values[s+3];case 3:a[2]=t.values[s+2];case 2:a[1]=t.values[s+1];case 1:a[0]=t.values[s];break;default:for(let u=i-1;u>=0;--u)a[u]=t.values[s+u]}return a},e.getTuples=(r,a)=>{const i=(r??0)*t.numberOfComponents,s=(a??e.getNumberOfTuples())*t.numberOfComponents,u=e.getData().subarray(i,s);return u.length>0?u:null},e.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*t.numberOfComponents},e.getNumberOfComponents=()=>t.numberOfComponents,e.getNumberOfValues=()=>t.size,e.getNumberOfTuples=()=>t.size/t.numberOfComponents,e.getDataType=()=>t.dataType,e.newClone=()=>fi({empty:!0,name:t.name,dataType:t.dataType,numberOfComponents:t.numberOfComponents}),e.getName=()=>(t.name||(e.modified(),t.name=`vtkDataArray${e.getMTime()}`),t.name),e.setData=(r,a)=>{t.values=r,t.size=r.length,t.dataType=Wn(r),a&&(t.numberOfComponents=a),t.size%t.numberOfComponents!==0&&(t.numberOfComponents=1),e.dataChange()},e.getState=()=>{if(t.deleted)return null;const r={...t,vtkClass:e.getClassName()};r.values=Array.from(r.values),delete r.buffer,Object.keys(r).forEach(i=>{r[i]||delete r[i]});const a={};return Object.keys(r).sort().forEach(i=>{a[i]=r[i]}),a.mtime&&delete a.mtime,a},e.deepCopy=r=>{const a=e.getDataType(),i=t.values;e.shallowCopy(r),(i==null?void 0:i.length)>=r.getNumberOfValues()&&a===r.getDataType()?(i.set(r.getData()),t.values=i,e.dataChange()):e.setData(r.getData().slice())},e.interpolateTuple=(r,a,i,s,u,o)=>{const c=t.numberOfComponents||1;(c!==a.getNumberOfComponents()||c!==s.getNumberOfComponents())&&Hu("numberOfComponents must match");const f=a.getTuple(i),g=s.getTuple(u),y=[];switch(y.length=c,c){case 4:y[3]=f[3]+(g[3]-f[3])*o;case 3:y[2]=f[2]+(g[2]-f[2])*o;case 2:y[1]=f[1]+(g[1]-f[1])*o;case 1:y[0]=f[0]+(g[0]-f[0])*o;break;default:for(let p=0;p<c;p++)y[p]=f[p]+(g[p]-f[p])*o}return e.insertTuple(r,y)}}const Qu={name:"",numberOfComponents:1,dataType:Gu,rangeTuple:[0,0]};function ci(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(t,Qu,n),!t.empty&&!t.values&&!t.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(t.values?Array.isArray(t.values)&&(t.values=_e(t.dataType,t.values)):t.values=we(t.dataType,t.size),t.values&&(t.size=t.size??t.values.length,t.dataType=Wn(t.values)),Ce(e,t),Oe(e,t,["name","numberOfComponents"]),t.size%t.numberOfComponents!==0)throw new RangeError("model.size is not a multiple of model.numberOfComponents");Xu(e,t)}const fi=xe(ci,"vtkDataArray");var Dt={newInstance:fi,extend:ci,...Yu,...si};const{vtkErrorMacro:li,vtkWarningMacro:Ju}=G;function qu(e,t){t.classHierarchy.push("vtkFieldData");const n=e.getState;t.arrays&&(t.arrays=t.arrays.map(r=>({data:dt(r.data)}))),e.initialize=()=>{e.initializeFields(),e.copyAllOn(),e.clearFieldFlags()},e.initializeFields=()=>{t.arrays=[],t.copyFieldFlags={},e.modified()},e.copyStructure=r=>{e.initializeFields(),t.copyFieldFlags=r.getCopyFieldFlags().map(a=>a),t.arrays=r.arrays().map(a=>({array:a}))},e.getNumberOfArrays=()=>t.arrays.length,e.getNumberOfActiveArrays=()=>t.arrays.length,e.addArray=r=>{const a=r.getName(),{array:i,index:s}=e.getArrayWithIndex(a);return i!=null?(t.arrays[s]={data:r},s):(t.arrays=[].concat(t.arrays,{data:r}),t.arrays.length-1)},e.removeAllArrays=()=>{t.arrays=[]},e.removeArray=r=>{const a=t.arrays.findIndex(i=>i.data.getName()===r);return e.removeArrayByIndex(a)},e.removeArrayByIndex=r=>r!==-1&&r<t.arrays.length?(t.arrays.splice(r,1),!0):!1,e.getArrays=()=>t.arrays.map(r=>r.data),e.getArray=r=>typeof r=="number"?e.getArrayByIndex(r):e.getArrayByName(r),e.getArrayByName=r=>t.arrays.reduce((a,i,s)=>i.data.getName()===r?i.data:a,null),e.getArrayWithIndex=r=>{const a=t.arrays.findIndex(i=>i.data.getName()===r);return{array:a!==-1?t.arrays[a].data:null,index:a}},e.getArrayByIndex=r=>r>=0&&r<t.arrays.length?t.arrays[r].data:null,e.hasArray=r=>e.getArrayWithIndex(r).index>=0,e.getArrayName=r=>{const a=t.arrays[r];return a?a.data.getName():""},e.getCopyFieldFlags=()=>t.copyFieldFlags,e.getFlag=r=>t.copyFieldFlags[r],e.passData=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;r.getArrays().forEach(s=>{const u=e.getFlag(s.getName());if(u!==!1&&!(t.doCopyAllOff&&u!==!0)&&s){let o=e.getArrayByName(s.getName());if(o)if(s.getNumberOfComponents()===o.getNumberOfComponents())if(a>-1&&a<s.getNumberOfTuples()){const c=i>-1?i:a;o.insertTuple(c,s.getTuple(a))}else o.insertTuples(0,s.getTuples());else li("Unhandled case in passData");else if(a<0||a>s.getNumberOfTuples())e.addArray(s),r.getAttributes(s).forEach(c=>{e.setAttribute(s,c)});else{const c=s.getNumberOfComponents();let f=s.getNumberOfValues();const g=i>-1?i:a;f<=g*c&&(f=(g+1)*c),o=Dt.newInstance({name:s.getName(),dataType:s.getDataType(),numberOfComponents:c,values:G.newTypedArray(s.getDataType(),f),size:0}),o.insertTuple(g,s.getTuple(a)),e.addArray(o),r.getAttributes(s).forEach(y=>{e.setAttribute(o,y)})}}})},e.interpolateData=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;r.getArrays().forEach(o=>{const c=e.getFlag(o.getName());if(c!==!1&&!(t.doCopyAllOff&&c!==!0)&&o){let f=e.getArrayByName(o.getName());if(f)if(o.getNumberOfComponents()===f.getNumberOfComponents())if(a>-1&&a<o.getNumberOfTuples()){const g=s>-1?s:a;f.interpolateTuple(g,o,a,o,i,u),Ju("Unexpected case in interpolateData")}else f.insertTuples(o.getTuples());else li("Unhandled case in interpolateData");else if(a<0||i<0||a>o.getNumberOfTuples())e.addArray(o),r.getAttributes(o).forEach(g=>{e.setAttribute(o,g)});else{const g=o.getNumberOfComponents();let y=o.getNumberOfValues();const p=s>-1?s:a;y<=p*g&&(y=(p+1)*g),f=Dt.newInstance({name:o.getName(),dataType:o.getDataType(),numberOfComponents:g,values:G.newTypedArray(o.getDataType(),y),size:0}),f.interpolateTuple(p,o,a,o,i,u),e.addArray(f),r.getAttributes(o).forEach(d=>{e.setAttribute(f,d)})}}})},e.copyFieldOn=r=>{t.copyFieldFlags[r]=!0},e.copyFieldOff=r=>{t.copyFieldFlags[r]=!1},e.copyAllOn=()=>{(!t.doCopyAllOn||t.doCopyAllOff)&&(t.doCopyAllOn=!0,t.doCopyAllOff=!1,e.modified())},e.copyAllOff=()=>{(t.doCopyAllOn||!t.doCopyAllOff)&&(t.doCopyAllOn=!1,t.doCopyAllOff=!0,e.modified())},e.clearFieldFlags=()=>{t.copyFieldFlags={}},e.deepCopy=r=>{t.arrays=r.getArrays().map(a=>{const i=a.newClone();return i.deepCopy(a),{data:i}})},e.copyFlags=r=>r.getCopyFieldFlags().map(a=>a),e.reset=()=>t.arrays.forEach(r=>r.data.reset()),e.getMTime=()=>t.arrays.reduce((r,a)=>a.data.getMTime()>r?a.data.getMTime():r,t.mtime),e.getNumberOfComponents=()=>t.arrays.reduce((r,a)=>r+a.data.getNumberOfComponents(),0),e.getNumberOfTuples=()=>t.arrays.length>0?t.arrays[0].getNumberOfTuples():0,e.getState=()=>{const r=n();return r&&(r.arrays=t.arrays.map(a=>({data:a.data.getState()}))),r}}const Zu={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function gi(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Zu,n),G.obj(e,t),qu(e,t)}var tc={newInstance:G.newInstance(gi,"vtkFieldData"),extend:gi},yi={AttributeCopyOperations:{COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},AttributeLimitTypes:{MAX:0,EXACT:1,NOLIMIT:2},AttributeTypes:{SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},CellGhostTypes:{DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},DesiredOutputPrecision:{DEFAULT:0,SINGLE:1,DOUBLE:2},PointGhostTypes:{DUPLICATEPOINT:1,HIDDENPOINT:2},ghostArrayName:"vtkGhostType"};const{AttributeTypes:It,AttributeCopyOperations:Pt}=yi,{vtkWarningMacro:Ve}=G;function ec(e,t){const n=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function r(s){let u=n.find(o=>It[o.toUpperCase()]===s||typeof s!="number"&&o.toLowerCase()===s.toLowerCase());return typeof u>"u"&&(u=null),u}t.classHierarchy.push("vtkDataSetAttributes");const a={...e};e.checkNumberOfComponents=s=>!0,e.setAttribute=(s,u)=>{const o=r(u);if(s&&o.toUpperCase()==="PEDIGREEIDS"&&!s.isA("vtkDataArray"))return Ve(`Cannot set attribute ${o}. The attribute must be a vtkDataArray.`),-1;if(s&&!e.checkNumberOfComponents(s,o))return Ve(`Cannot set attribute ${o}. Incorrect number of components.`),-1;let c=t[`active${o}`];if(c>=0&&c<t.arrays.length){if(t.arrays[c]===s)return c;e.removeArrayByIndex(c)}return s?(c=e.addArray(s),t[`active${o}`]=c):t[`active${o}`]=-1,e.modified(),t[`active${o}`]},e.getAttributes=s=>n.filter(u=>e[`get${u}`]()===s),e.setActiveAttributeByName=(s,u)=>e.setActiveAttributeByIndex(e.getArrayWithIndex(s).index,u),e.setActiveAttributeByIndex=(s,u)=>{const o=r(u);if(s>=0&&s<t.arrays.length){if(o.toUpperCase()!=="PEDIGREEIDS"){const c=e.getArrayByIndex(s);if(!c.isA("vtkDataArray"))return Ve(`Cannot set attribute ${o}. Only vtkDataArray subclasses can be set as active attributes.`),-1;if(!e.checkNumberOfComponents(c,o))return Ve(`Cannot set attribute ${o}. Incorrect number of components.`),-1}return t[`active${o}`]=s,e.modified(),s}return s===-1&&(t[`active${o}`]=s,e.modified()),-1},e.getActiveAttribute=s=>{const u=r(s);return e[`get${u}`]()},e.removeAllArrays=()=>{n.forEach(s=>{t[`active${s}`]=-1}),a.removeAllArrays()},e.removeArrayByIndex=s=>(s!==-1&&n.forEach(u=>{s===t[`active${u}`]?t[`active${u}`]=-1:s<t[`active${u}`]&&(t[`active${u}`]-=1)}),a.removeArrayByIndex(s)),n.forEach(s=>{const u=`active${s}`;e[`get${s}`]=()=>e.getArrayByIndex(t[u]),e[`set${s}`]=o=>e.setAttribute(o,s),e[`setActive${s}`]=o=>e.setActiveAttributeByIndex(e.getArrayWithIndex(o).index,s),e[`copy${s}Off`]=()=>{const o=s.toUpperCase();t.copyAttributeFlags[Pt.PASSDATA][It[o]]=!1},e[`copy${s}On`]=()=>{const o=s.toUpperCase();t.copyAttributeFlags[Pt.PASSDATA][It[o]]=!0}}),e.initializeAttributeCopyFlags=()=>{t.copyAttributeFlags=[],Object.keys(Pt).filter(s=>s!=="ALLCOPY").forEach(s=>{t.copyAttributeFlags[Pt[s]]=Object.keys(It).filter(u=>u!=="NUM_ATTRIBUTES").reduce((u,o)=>(u[It[o]]=!0,u),[])}),t.copyAttributeFlags[Pt.COPYTUPLE][It.GLOBALIDS]=!1,t.copyAttributeFlags[Pt.INTERPOLATE][It.GLOBALIDS]=!1,t.copyAttributeFlags[Pt.COPYTUPLE][It.PEDIGREEIDS]=!1},e.initialize=G.chain(e.initialize,e.initializeAttributeCopyFlags),t.dataArrays&&Object.keys(t.dataArrays).length&&Object.keys(t.dataArrays).forEach(s=>{!t.dataArrays[s].ref&&t.dataArrays[s].type==="vtkDataArray"&&e.addArray(Dt.newInstance(t.dataArrays[s]))});const i=e.shallowCopy;e.shallowCopy=(s,u)=>{i(s,u),t.arrays=s.getArrays().map(o=>{const c=o.newClone();return c.shallowCopy(o,u),{data:c}})},e.initializeAttributeCopyFlags()}const nc={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function hi(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,nc,n),tc.extend(e,t,n),G.setGet(e,t,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),t.arrays||(t.arrays={}),ec(e,t)}var pi={newInstance:G.newInstance(hi,"vtkDataSetAttributes"),extend:hi,...yi},rc={FieldDataTypes:{UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},FieldAssociations:{FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7}};const Bn=["pointData","cellData","fieldData"];function ac(e,t){t.classHierarchy.push("vtkDataSet"),Bn.forEach(r=>{t[r]?t[r]=dt(t[r]):t[r]=pi.newInstance()});const n=e.shallowCopy;e.shallowCopy=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,a),Bn.forEach(i=>{t[i]=pi.newInstance(),t[i].shallowCopy(r.getReferenceByName(i))})}}const ic={};function vi(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,ic,n),G.obj(e,t),G.setGet(e,t,Bn),ac(e,t)}var di={newInstance:G.newInstance(vi,"vtkDataSet"),extend:vi,...rc};const mt={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9};var mi={StructuredType:mt};const{StructuredType:At}=mi;function sc(e){let t=0;for(let n=0;n<3;++n)e[n*2]<e[n*2+1]&&t++;return e[0]>e[1]||e[2]>e[3]||e[4]>e[5]?At.EMPTY:t===3?At.XYZ_GRID:t===2?e[0]===e[1]?At.YZ_PLANE:e[2]===e[3]?At.XZ_PLANE:At.XY_PLANE:t===1?e[0]<e[1]?At.X_LINE:e[2]<e[3]?At.Y_LINE:At.Z_LINE:At.SINGLE_POINT}var oc={getDataDescriptionFromExtent:sc,...mi};const{vtkErrorMacro:zt}=G;function uc(e,t){t.classHierarchy.push("vtkImageData"),e.setExtent=function(){if(t.deleted)return zt("instance deleted - cannot call any method"),!1;for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];const i=r.length===1?r[0]:r;if(i.length!==6)return!1;const s=t.extent.some((u,o)=>u!==i[o]);return s&&(t.extent=i.slice(),t.dataDescription=oc.getDataDescriptionFromExtent(t.extent),e.modified()),s},e.setDimensions=function(){let n,r,a;if(t.deleted){zt("instance deleted - cannot call any method");return}if(arguments.length===1){const i=arguments.length<=0?void 0:arguments[0];n=i[0],r=i[1],a=i[2]}else if(arguments.length===3)n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],a=arguments.length<=2?void 0:arguments[2];else{zt("Bad dimension specification");return}e.setExtent(0,n-1,0,r-1,0,a-1)},e.getDimensions=()=>[t.extent[1]-t.extent[0]+1,t.extent[3]-t.extent[2]+1,t.extent[5]-t.extent[4]+1],e.getNumberOfCells=()=>{const n=e.getDimensions();let r=1;for(let a=0;a<3;a++){if(n[a]===0)return 0;n[a]>1&&(r*=n[a]-1)}return r},e.getNumberOfPoints=()=>{const n=e.getDimensions();return n[0]*n[1]*n[2]},e.getPoint=n=>{const r=e.getDimensions();if(r[0]===0||r[1]===0||r[2]===0)return zt("Requesting a point from an empty image."),null;const a=new Float64Array(3);switch(t.dataDescription){case mt.EMPTY:return null;case mt.SINGLE_POINT:break;case mt.X_LINE:a[0]=n;break;case mt.Y_LINE:a[1]=n;break;case mt.Z_LINE:a[2]=n;break;case mt.XY_PLANE:a[0]=n%r[0],a[1]=n/r[0];break;case mt.YZ_PLANE:a[1]=n%r[1],a[2]=n/r[1];break;case mt.XZ_PLANE:a[0]=n%r[0],a[2]=n/r[0];break;case mt.XYZ_GRID:a[0]=n%r[0],a[1]=n/r[0]%r[1],a[2]=n/(r[0]*r[1]);break;default:zt("Invalid dataDescription");break}const i=[0,0,0];return e.indexToWorld(a,i),i},e.getBounds=()=>e.extentToBounds(e.getSpatialExtent()),e.extentToBounds=n=>Zt.transformBounds(n,t.indexToWorld),e.getSpatialExtent=()=>Zt.inflate([...t.extent],.5),e.computeTransforms=()=>{xu(t.indexToWorld,t.origin),t.indexToWorld[0]=t.direction[0],t.indexToWorld[1]=t.direction[1],t.indexToWorld[2]=t.direction[2],t.indexToWorld[4]=t.direction[3],t.indexToWorld[5]=t.direction[4],t.indexToWorld[6]=t.direction[5],t.indexToWorld[8]=t.direction[6],t.indexToWorld[9]=t.direction[7],t.indexToWorld[10]=t.direction[8],Su(t.indexToWorld,t.indexToWorld,t.spacing),Ou(t.worldToIndex,t.indexToWorld)},e.indexToWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return bn(r,n,t.indexToWorld),r},e.indexToWorldVec3=e.indexToWorld,e.worldToIndex=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return bn(r,n,t.worldToIndex),r},e.worldToIndexVec3=e.worldToIndex,e.indexToWorldBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Zt.transformBounds(n,t.indexToWorld,r)},e.worldToIndexBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Zt.transformBounds(n,t.worldToIndex,r)},e.onModified(e.computeTransforms),e.computeTransforms(),e.getCenter=()=>Zt.getCenter(e.getBounds()),e.computeHistogram=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const a=[0,0,0,0,0,0];e.worldToIndexBounds(n,a);const i=[0,0,0],s=[0,0,0];Zt.computeCornerPoints(a,i,s),xa(i,i),xa(s,s);const u=e.getDimensions();Da(i,[0,0,0],[u[0]-1,u[1]-1,u[2]-1],i),Da(s,[0,0,0],[u[0]-1,u[1]-1,u[2]-1],s);const o=u[0],c=u[0]*u[1],f=e.getPointData().getScalars().getData();let g=-1/0,y=1/0,p=0,d=0,m=0;for(let _=i[2];_<=s[2];_++)for(let D=i[1];D<=s[1];D++){let R=i[0]+D*o+_*c;for(let M=i[0];M<=s[0];M++){if(!r||r([M,D,_],a)){const b=f[R];b>g&&(g=b),b<y&&(y=b),p+=b*b,d+=b,m+=1}++R}}const x=m>0?d/m:0,L=m?Math.abs(p/m-x*x):0,A=Math.sqrt(L);return{minimum:y,maximum:g,average:x,variance:L,sigma:A,count:m}},e.computeIncrements=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const a=[];let i=r;for(let s=0;s<3;++s)a[s]=i,i*=n[s*2+1]-n[s*2]+1;return a},e.computeOffsetIndex=n=>{let[r,a,i]=n;const s=e.getExtent(),u=e.getPointData().getScalars().getNumberOfComponents(),o=e.computeIncrements(s,u);return Math.floor((Math.round(r)-s[0])*o[0]+(Math.round(a)-s[2])*o[1]+(Math.round(i)-s[4])*o[2])},e.getOffsetIndexFromWorld=n=>{const r=e.getExtent(),a=e.worldToIndex(n);for(let i=0;i<3;++i)if(a[i]<r[i*2]||a[i]>r[i*2+1])return zt(`GetScalarPointer: Pixel ${a} is not in memory. Current extent = ${r}`),NaN;return e.computeOffsetIndex(a)},e.getScalarValueFromWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const a=e.getPointData().getScalars().getNumberOfComponents();if(r<0||r>=a)return zt(`GetScalarPointer: Scalar Component ${r} is not within bounds. Current Scalar numberOfComponents: ${a}`),NaN;const i=e.getOffsetIndexFromWorld(n);return Number.isNaN(i)?i:e.getPointData().getScalars().getComponent(i,r)}}const cc={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:mt.EMPTY};function Ti(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,cc,n),di.extend(e,t,n),t.direction?Array.isArray(t.direction)&&(t.direction=new Float64Array(t.direction.slice(0,9))):t.direction=Cu(new Float64Array(9)),t.indexToWorld=new Float64Array(16),t.worldToIndex=new Float64Array(16),G.get(e,t,["indexToWorld","worldToIndex"]),G.setGetArray(e,t,["origin","spacing"],3),G.setGetArray(e,t,["direction"],9),G.getArray(e,t,["extent"],6),uc(e,t)}var Ue={newInstance:G.newInstance(Ti,"vtkImageData"),extend:Ti},fc=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(t){t=t||{};var n=typeof t<"u"?t:{},r,a;n.ready=new Promise(function(l,h){r=l,a=h});var i=Object.assign({},n),s="./this.program",u=(l,h)=>{throw h},o=!0,c="";function f(l){return n.locateFile?n.locateFile(l,c):c+l}var g;typeof document<"u"&&document.currentScript&&(c=document.currentScript.src),e&&(c=e),c.indexOf("blob:")!==0?c=c.substr(0,c.replace(/[?#].*/,"").lastIndexOf("/")+1):c="";var y=n.print||console.log.bind(console),p=n.printErr||console.warn.bind(console);Object.assign(n,i),i=null,n.arguments&&n.arguments,n.thisProgram&&(s=n.thisProgram),n.quit&&(u=n.quit);var d=4,m;n.wasmBinary&&(m=n.wasmBinary);var x=n.noExitRuntime||!0;typeof WebAssembly!="object"&&Be("no native wasm support detected");var L,A=!1,_,D=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function R(l,h,v){for(var T=h+v,w=h;l[w]&&!(w>=T);)++w;if(w-h>16&&l.buffer&&D)return D.decode(l.subarray(h,w));for(var S="";h<w;){var E=l[h++];if(!(E&128)){S+=String.fromCharCode(E);continue}var O=l[h++]&63;if((E&224)==192){S+=String.fromCharCode((E&31)<<6|O);continue}var C=l[h++]&63;if((E&240)==224?E=(E&15)<<12|O<<6|C:E=(E&7)<<18|O<<12|C<<6|l[h++]&63,E<65536)S+=String.fromCharCode(E);else{var I=E-65536;S+=String.fromCharCode(55296|I>>10,56320|I&1023)}}return S}function M(l,h){return l?R(V,l,h):""}function b(l,h,v,T){if(!(T>0))return 0;for(var w=v,S=v+T-1,E=0;E<l.length;++E){var O=l.charCodeAt(E);if(O>=55296&&O<=57343){var C=l.charCodeAt(++E);O=65536+((O&1023)<<10)|C&1023}if(O<=127){if(v>=S)break;h[v++]=O}else if(O<=2047){if(v+1>=S)break;h[v++]=192|O>>6,h[v++]=128|O&63}else if(O<=65535){if(v+2>=S)break;h[v++]=224|O>>12,h[v++]=128|O>>6&63,h[v++]=128|O&63}else{if(v+3>=S)break;h[v++]=240|O>>18,h[v++]=128|O>>12&63,h[v++]=128|O>>6&63,h[v++]=128|O&63}}return h[v]=0,v-w}function k(l,h,v){return b(l,V,h,v)}function j(l){for(var h=0,v=0;v<l.length;++v){var T=l.charCodeAt(v);T<=127?h++:T<=2047?h+=2:T>=55296&&T<=57343?(h+=4,++v):h+=3}return h}var $,F,V,H,U,z,P,at,Ct;function ot(l){$=l,n.HEAP8=F=new Int8Array(l),n.HEAP16=H=new Int16Array(l),n.HEAP32=z=new Int32Array(l),n.HEAPU8=V=new Uint8Array(l),n.HEAPU16=U=new Uint16Array(l),n.HEAPU32=P=new Uint32Array(l),n.HEAPF32=at=new Float32Array(l),n.HEAPF64=Ct=new Float64Array(l)}n.INITIAL_MEMORY;var lt,Mt=[],Ht=[],lf=[],Wi=[];function gf(){return x}function yf(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)df(n.preRun.shift());Ke(Mt)}function hf(){Ke(Ht)}function pf(){Ke(lf)}function vf(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)Tf(n.postRun.shift());Ke(Wi)}function df(l){Mt.unshift(l)}function mf(l){Ht.unshift(l)}function Tf(l){Wi.unshift(l)}var Gt=0,ie=null;function wf(l){Gt++,n.monitorRunDependencies&&n.monitorRunDependencies(Gt)}function _f(l){if(Gt--,n.monitorRunDependencies&&n.monitorRunDependencies(Gt),Gt==0&&ie){var h=ie;ie=null,h()}}function Be(l){n.onAbort&&n.onAbort(l),l="Aborted("+l+")",p(l),A=!0,_=1,l+=". Build with -sASSERTIONS for more info.";var h=new WebAssembly.RuntimeError(l);throw a(h),h}var Ef="data:application/octet-stream;base64,";function Bi(l){return l.startsWith(Ef)}var Tt;Tt="ICRPolySeg.wasm",Bi(Tt)||(Tt=f(Tt));function Ki(l){try{if(l==Tt&&m)return new Uint8Array(m);throw"both async and sync fetching of the wasm failed"}catch(h){Be(h)}}function Cf(){return!m&&o&&typeof fetch=="function"?fetch(Tt,{credentials:"same-origin"}).then(function(l){if(!l.ok)throw"failed to load wasm binary file at '"+Tt+"'";return l.arrayBuffer()}).catch(function(){return Ki(Tt)}):Promise.resolve().then(function(){return Ki(Tt)})}function Of(){var l={a:ng};function h(E,O){var C=E.exports;n.asm=C,L=n.asm.Q,ot(L.buffer),lt=n.asm.T,mf(n.asm.R),_f()}wf();function v(E){h(E.instance)}function T(E){return Cf().then(function(O){return WebAssembly.instantiate(O,l)}).then(function(O){return O}).then(E,function(O){p("failed to asynchronously prepare wasm: "+O),Be(O)})}function w(){return!m&&typeof WebAssembly.instantiateStreaming=="function"&&!Bi(Tt)&&typeof fetch=="function"?fetch(Tt,{credentials:"same-origin"}).then(function(E){var O=WebAssembly.instantiateStreaming(E,l);return O.then(v,function(C){return p("wasm streaming compile failed: "+C),p("falling back to ArrayBuffer instantiation"),T(v)})}):T(v)}if(n.instantiateWasm)try{var S=n.instantiateWasm(l,h);return S}catch(E){p("Module.instantiateWasm callback failed with error: "+E),a(E)}return w().catch(a),{}}var Sf={638383:l=>{n.updateProgress&&n.updateProgress(l)}};function Yi(l){this.name="ExitStatus",this.message="Program terminated with exit("+l+")",this.status=l}function Ke(l){for(;l.length>0;)l.shift()(n)}function xf(l){this.excPtr=l,this.ptr=l-24,this.set_type=function(h){P[this.ptr+4>>2]=h},this.get_type=function(){return P[this.ptr+4>>2]},this.set_destructor=function(h){P[this.ptr+8>>2]=h},this.get_destructor=function(){return P[this.ptr+8>>2]},this.set_refcount=function(h){z[this.ptr>>2]=h},this.set_caught=function(h){h=h?1:0,F[this.ptr+12>>0]=h},this.get_caught=function(){return F[this.ptr+12>>0]!=0},this.set_rethrown=function(h){h=h?1:0,F[this.ptr+13>>0]=h},this.get_rethrown=function(){return F[this.ptr+13>>0]!=0},this.init=function(h,v){this.set_adjusted_ptr(0),this.set_type(h),this.set_destructor(v),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var h=z[this.ptr>>2];z[this.ptr>>2]=h+1},this.release_ref=function(){var h=z[this.ptr>>2];return z[this.ptr>>2]=h-1,h===1},this.set_adjusted_ptr=function(h){P[this.ptr+16>>2]=h},this.get_adjusted_ptr=function(){return P[this.ptr+16>>2]},this.get_exception_ptr=function(){var h=ys(this.get_type());if(h)return P[this.excPtr>>2];var v=this.get_adjusted_ptr();return v!==0?v:this.excPtr}}function Df(l,h,v){var T=new xf(l);throw T.init(h,v),l}function Af(l,h){}function Mf(l,h,v){}function kf(l,h,v,T){}function Lf(l,h,v,T){}function Nf(l,h){}var Ye={};function er(l){for(;l.length;){var h=l.pop(),v=l.pop();v(h)}}function Xe(l){return this.fromWireType(z[l>>2])}var ee={},Wt={},Qe={},Rf=48,bf=57;function nr(l){if(l===void 0)return"_unknown";l=l.replace(/[^a-zA-Z0-9_]/g,"$");var h=l.charCodeAt(0);return h>=Rf&&h<=bf?"_"+l:l}function Xi(l,h){return l=nr(l),new Function("body","return function "+l+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(h)}function rr(l,h){var v=Xi(h,function(T){this.name=h,this.message=T;var w=new Error(T).stack;w!==void 0&&(this.stack=this.toString()+`
`+w.replace(/^Error(:[^\n]*)?\n/,""))});return v.prototype=Object.create(l.prototype),v.prototype.constructor=v,v.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},v}var Qi=void 0;function Ji(l){throw new Qi(l)}function qi(l,h,v){l.forEach(function(O){Qe[O]=h});function T(O){var C=v(O);C.length!==l.length&&Ji("Mismatched type converter count");for(var I=0;I<l.length;++I)kt(l[I],C[I])}var w=new Array(h.length),S=[],E=0;h.forEach((O,C)=>{Wt.hasOwnProperty(O)?w[C]=Wt[O]:(S.push(O),ee.hasOwnProperty(O)||(ee[O]=[]),ee[O].push(()=>{w[C]=Wt[O],++E,E===S.length&&T(w)}))}),S.length===0&&T(w)}function If(l){var h=Ye[l];delete Ye[l];var v=h.rawConstructor,T=h.rawDestructor,w=h.fields,S=w.map(E=>E.getterReturnType).concat(w.map(E=>E.setterArgumentType));qi([l],S,E=>{var O={};return w.forEach((C,I)=>{var Q=C.fieldName,B=E[I],K=C.getter,ct=C.getterContext,st=E[I+w.length],Ot=C.setter,_t=C.setterContext;O[Q]={read:Nt=>B.fromWireType(K(ct,Nt)),write:(Nt,N)=>{var W=[];Ot(_t,Nt,st.toWireType(W,N)),er(W)}}}),[{name:h.name,fromWireType:function(C){var I={};for(var Q in O)I[Q]=O[Q].read(C);return T(C),I},toWireType:function(C,I){for(var Q in O)if(!(Q in I))throw new TypeError('Missing field:  "'+Q+'"');var B=v();for(Q in O)O[Q].write(B,I[Q]);return C!==null&&C.push(T,B),B},argPackAdvance:8,readValueFromPointer:Xe,destructorFunction:T}]})}function Ff(l,h,v,T,w){}function ar(l){switch(l){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+l)}}function $f(){for(var l=new Array(256),h=0;h<256;++h)l[h]=String.fromCharCode(h);Zi=l}var Zi=void 0;function ut(l){for(var h="",v=l;V[v];)h+=Zi[V[v++]];return h}var ts=void 0;function gt(l){throw new ts(l)}function kt(l,h,v={}){if(!("argPackAdvance"in h))throw new TypeError("registerType registeredInstance requires argPackAdvance");var T=h.name;if(l||gt('type "'+T+'" must have a positive integer typeid pointer'),Wt.hasOwnProperty(l)){if(v.ignoreDuplicateRegistrations)return;gt("Cannot register type '"+T+"' twice")}if(Wt[l]=h,delete Qe[l],ee.hasOwnProperty(l)){var w=ee[l];delete ee[l],w.forEach(S=>S())}}function Vf(l,h,v,T,w){var S=ar(v);h=ut(h),kt(l,{name:h,fromWireType:function(E){return!!E},toWireType:function(E,O){return O?T:w},argPackAdvance:8,readValueFromPointer:function(E){var O;if(v===1)O=F;else if(v===2)O=H;else if(v===4)O=z;else throw new TypeError("Unknown boolean type size: "+h);return this.fromWireType(O[E>>S])},destructorFunction:null})}var ir=[],wt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function sr(l){l>4&&--wt[l].refcount===0&&(wt[l]=void 0,ir.push(l))}function Uf(){for(var l=0,h=5;h<wt.length;++h)wt[h]!==void 0&&++l;return l}function jf(){for(var l=5;l<wt.length;++l)if(wt[l]!==void 0)return wt[l];return null}function Pf(){n.count_emval_handles=Uf,n.get_first_emval=jf}var it={toValue:l=>(l||gt("Cannot use deleted val. handle = "+l),wt[l].value),toHandle:l=>{switch(l){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var h=ir.length?ir.pop():wt.length;return wt[h]={refcount:1,value:l},h}}}};function zf(l,h){h=ut(h),kt(l,{name:h,fromWireType:function(v){var T=it.toValue(v);return sr(v),T},toWireType:function(v,T){return it.toHandle(T)},argPackAdvance:8,readValueFromPointer:Xe,destructorFunction:null})}function Hf(l,h){switch(h){case 2:return function(v){return this.fromWireType(at[v>>2])};case 3:return function(v){return this.fromWireType(Ct[v>>3])};default:throw new TypeError("Unknown float type: "+l)}}function Gf(l,h,v){var T=ar(v);h=ut(h),kt(l,{name:h,fromWireType:function(w){return w},toWireType:function(w,S){return S},argPackAdvance:8,readValueFromPointer:Hf(h,T),destructorFunction:null})}function es(l,h){if(!(l instanceof Function))throw new TypeError("new_ called with constructor type "+typeof l+" which is not a function");var v=Xi(l.name||"unknownFunctionName",function(){});v.prototype=l.prototype;var T=new v,w=l.apply(T,h);return w instanceof Object?w:T}function Wf(l,h,v,T,w){var S=h.length;S<2&&gt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var E=h[1]!==null&&v!==null,O=!1,C=1;C<h.length;++C)if(h[C]!==null&&h[C].destructorFunction===void 0){O=!0;break}for(var I=h[0].name!=="void",Q="",B="",C=0;C<S-2;++C)Q+=(C!==0?", ":"")+"arg"+C,B+=(C!==0?", ":"")+"arg"+C+"Wired";var K="return function "+nr(l)+"("+Q+`) {
if (arguments.length !== `+(S-2)+`) {
throwBindingError('function `+l+" called with ' + arguments.length + ' arguments, expected "+(S-2)+` args!');
}
`;O&&(K+=`var destructors = [];
`);var ct=O?"destructors":"null",st=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],Ot=[gt,T,w,er,h[0],h[1]];E&&(K+="var thisWired = classParam.toWireType("+ct+`, this);
`);for(var C=0;C<S-2;++C)K+="var arg"+C+"Wired = argType"+C+".toWireType("+ct+", arg"+C+"); // "+h[C+2].name+`
`,st.push("argType"+C),Ot.push(h[C+2]);if(E&&(B="thisWired"+(B.length>0?", ":"")+B),K+=(I?"var rv = ":"")+"invoker(fn"+(B.length>0?", ":"")+B+`);
`,O)K+=`runDestructors(destructors);
`;else for(var C=E?1:2;C<h.length;++C){var _t=C===1?"thisWired":"arg"+(C-2)+"Wired";h[C].destructorFunction!==null&&(K+=_t+"_dtor("+_t+"); // "+h[C].name+`
`,st.push(_t+"_dtor"),Ot.push(h[C].destructorFunction))}I&&(K+=`var ret = retType.fromWireType(rv);
return ret;
`),K+=`}
`,st.push(K);var Nt=es(Function,st).apply(null,Ot);return Nt}function Bf(l,h,v){if(l[h].overloadTable===void 0){var T=l[h];l[h]=function(){return l[h].overloadTable.hasOwnProperty(arguments.length)||gt("Function '"+v+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+l[h].overloadTable+")!"),l[h].overloadTable[arguments.length].apply(this,arguments)},l[h].overloadTable=[],l[h].overloadTable[T.argCount]=T}}function Kf(l,h,v){n.hasOwnProperty(l)?((v===void 0||n[l].overloadTable!==void 0&&n[l].overloadTable[v]!==void 0)&&gt("Cannot register public name '"+l+"' twice"),Bf(n,l,l),n.hasOwnProperty(v)&&gt("Cannot register multiple overloads of a function with the same number of arguments ("+v+")!"),n[l].overloadTable[v]=h):(n[l]=h,v!==void 0&&(n[l].numArguments=v))}function Yf(l,h){for(var v=[],T=0;T<l;T++)v.push(P[h+T*4>>2]);return v}function Xf(l,h,v){n.hasOwnProperty(l)||Ji("Replacing nonexistant public symbol"),n[l].overloadTable!==void 0&&v!==void 0?n[l].overloadTable[v]=h:(n[l]=h,n[l].argCount=v)}function Qf(l,h,v){var T=n["dynCall_"+l];return v&&v.length?T.apply(null,[h].concat(v)):T.call(null,h)}var Je=[];function ns(l){var h=Je[l];return h||(l>=Je.length&&(Je.length=l+1),Je[l]=h=lt.get(l)),h}function Jf(l,h,v){if(l.includes("j"))return Qf(l,h,v);var T=ns(h).apply(null,v);return T}function qf(l,h){var v=[];return function(){return v.length=0,Object.assign(v,arguments),Jf(l,h,v)}}function se(l,h){l=ut(l);function v(){return l.includes("j")?qf(l,h):ns(h)}var T=v();return typeof T!="function"&&gt("unknown function pointer with signature "+l+": "+h),T}var rs=void 0;function as(l){var h=gs(l),v=ut(h);return Lt(h),v}function Zf(l,h){var v=[],T={};function w(S){if(!T[S]&&!Wt[S]){if(Qe[S]){Qe[S].forEach(w);return}v.push(S),T[S]=!0}}throw h.forEach(w),new rs(l+": "+v.map(as).join([", "]))}function tl(l,h,v,T,w,S){var E=Yf(h,v);l=ut(l),w=se(T,w),Kf(l,function(){Zf("Cannot call "+l+" due to unbound types",E)},h-1),qi([],E,function(O){var C=[O[0],null].concat(O.slice(1));return Xf(l,Wf(l,C,null,w,S),h-1),[]})}function el(l,h,v){switch(h){case 0:return v?function(w){return F[w]}:function(w){return V[w]};case 1:return v?function(w){return H[w>>1]}:function(w){return U[w>>1]};case 2:return v?function(w){return z[w>>2]}:function(w){return P[w>>2]};default:throw new TypeError("Unknown integer type: "+l)}}function nl(l,h,v,T,w){h=ut(h);var S=ar(v),E=B=>B;if(T===0){var O=32-8*v;E=B=>B<<O>>>O}var C=h.includes("unsigned"),I=(B,K)=>{},Q;C?Q=function(B,K){return I(K,this.name),K>>>0}:Q=function(B,K){return I(K,this.name),K},kt(l,{name:h,fromWireType:E,toWireType:Q,argPackAdvance:8,readValueFromPointer:el(h,S,T!==0),destructorFunction:null})}function rl(l,h,v){var T=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],w=T[h];function S(E){E=E>>2;var O=P,C=O[E],I=O[E+1];return new w($,I,C)}v=ut(v),kt(l,{name:v,fromWireType:S,argPackAdvance:8,readValueFromPointer:S},{ignoreDuplicateRegistrations:!0})}function al(l,h){h=ut(h);var v=h==="std::string";kt(l,{name:h,fromWireType:function(T){var w=P[T>>2],S=T+4,E;if(v)for(var O=S,C=0;C<=w;++C){var I=S+C;if(C==w||V[I]==0){var Q=I-O,B=M(O,Q);E===void 0?E=B:(E+="\0",E+=B),O=I+1}}else{for(var K=new Array(w),C=0;C<w;++C)K[C]=String.fromCharCode(V[S+C]);E=K.join("")}return Lt(T),E},toWireType:function(T,w){w instanceof ArrayBuffer&&(w=new Uint8Array(w));var S,E=typeof w=="string";E||w instanceof Uint8Array||w instanceof Uint8ClampedArray||w instanceof Int8Array||gt("Cannot pass non-string to std::string"),v&&E?S=j(w):S=w.length;var O=lr(4+S+1),C=O+4;if(P[O>>2]=S,v&&E)k(w,C,S+1);else if(E)for(var I=0;I<S;++I){var Q=w.charCodeAt(I);Q>255&&(Lt(C),gt("String has UTF-16 code units that do not fit in 8 bits")),V[C+I]=Q}else for(var I=0;I<S;++I)V[C+I]=w[I];return T!==null&&T.push(Lt,O),O},argPackAdvance:8,readValueFromPointer:Xe,destructorFunction:function(T){Lt(T)}})}var is=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function il(l,h){for(var v=l,T=v>>1,w=T+h/2;!(T>=w)&&U[T];)++T;if(v=T<<1,v-l>32&&is)return is.decode(V.subarray(l,v));for(var S="",E=0;!(E>=h/2);++E){var O=H[l+E*2>>1];if(O==0)break;S+=String.fromCharCode(O)}return S}function sl(l,h,v){if(v===void 0&&(v=2147483647),v<2)return 0;v-=2;for(var T=h,w=v<l.length*2?v/2:l.length,S=0;S<w;++S){var E=l.charCodeAt(S);H[h>>1]=E,h+=2}return H[h>>1]=0,h-T}function ol(l){return l.length*2}function ul(l,h){for(var v=0,T="";!(v>=h/4);){var w=z[l+v*4>>2];if(w==0)break;if(++v,w>=65536){var S=w-65536;T+=String.fromCharCode(55296|S>>10,56320|S&1023)}else T+=String.fromCharCode(w)}return T}function cl(l,h,v){if(v===void 0&&(v=2147483647),v<4)return 0;for(var T=h,w=T+v-4,S=0;S<l.length;++S){var E=l.charCodeAt(S);if(E>=55296&&E<=57343){var O=l.charCodeAt(++S);E=65536+((E&1023)<<10)|O&1023}if(z[h>>2]=E,h+=4,h+4>w)break}return z[h>>2]=0,h-T}function fl(l){for(var h=0,v=0;v<l.length;++v){var T=l.charCodeAt(v);T>=55296&&T<=57343&&++v,h+=4}return h}function ll(l,h,v){v=ut(v);var T,w,S,E,O;h===2?(T=il,w=sl,E=ol,S=()=>U,O=1):h===4&&(T=ul,w=cl,E=fl,S=()=>P,O=2),kt(l,{name:v,fromWireType:function(C){for(var I=P[C>>2],Q=S(),B,K=C+4,ct=0;ct<=I;++ct){var st=C+4+ct*h;if(ct==I||Q[st>>O]==0){var Ot=st-K,_t=T(K,Ot);B===void 0?B=_t:(B+="\0",B+=_t),K=st+h}}return Lt(C),B},toWireType:function(C,I){typeof I!="string"&&gt("Cannot pass non-string to C++ string type "+v);var Q=E(I),B=lr(4+Q+h);return P[B>>2]=Q>>O,w(I,B+4,Q+h),C!==null&&C.push(Lt,B),B},argPackAdvance:8,readValueFromPointer:Xe,destructorFunction:function(C){Lt(C)}})}function gl(l,h,v,T,w,S){Ye[l]={name:ut(h),rawConstructor:se(v,T),rawDestructor:se(w,S),fields:[]}}function yl(l,h,v,T,w,S,E,O,C,I){Ye[l].fields.push({fieldName:ut(h),getterReturnType:v,getter:se(T,w),getterContext:S,setterArgumentType:E,setter:se(O,C),setterContext:I})}function hl(l,h){h=ut(h),kt(l,{isVoid:!0,name:h,argPackAdvance:0,fromWireType:function(){},toWireType:function(v,T){}})}function qe(l,h){var v=Wt[l];return v===void 0&&gt(h+" has unknown type "+as(l)),v}function pl(l,h,v){l=it.toValue(l),h=qe(h,"emval::as");var T=[],w=it.toHandle(T);return P[v>>2]=w,h.toWireType(T,l)}var vl={};function or(l){var h=vl[l];return h===void 0?ut(l):h}var ur=[];function dl(l,h,v,T){l=ur[l],h=it.toValue(h),v=or(v),l(h,v,null,T)}function ss(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function ml(l){return l===0?it.toHandle(ss()):(l=or(l),it.toHandle(ss()[l]))}function Tl(l){var h=ur.length;return ur.push(l),h}function wl(l,h){for(var v=new Array(l),T=0;T<l;++T)v[T]=qe(P[h+T*d>>2],"parameter "+T);return v}var os=[];function _l(l,h){var v=wl(l,h),T=v[0],w=T.name+"_$"+v.slice(1).map(function(st){return st.name}).join("_")+"$",S=os[w];if(S!==void 0)return S;for(var E=["retType"],O=[T],C="",I=0;I<l-1;++I)C+=(I!==0?", ":"")+"arg"+I,E.push("argType"+I),O.push(v[1+I]);for(var Q=nr("methodCaller_"+w),B="return function "+Q+`(handle, name, destructors, args) {
`,K=0,I=0;I<l-1;++I)B+="    var arg"+I+" = argType"+I+".readValueFromPointer(args"+(K?"+"+K:"")+`);
`,K+=v[I+1].argPackAdvance;B+="    var rv = handle[name]("+C+`);
`;for(var I=0;I<l-1;++I)v[I+1].deleteObject&&(B+="    argType"+I+".deleteObject(arg"+I+`);
`);T.isVoid||(B+=`    return retType.toWireType(destructors, rv);
`),B+=`};
`,E.push(B);var ct=es(Function,E).apply(null,O);return S=Tl(ct),os[w]=S,S}function El(l,h){return l=it.toValue(l),h=it.toValue(h),it.toHandle(l[h])}function Cl(l){l>4&&(wt[l].refcount+=1)}function Ol(l){for(var h="",v=0;v<l;++v)h+=(v!==0?", ":"")+"arg"+v;for(var T=()=>P,w="return function emval_allocator_"+l+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,v=0;v<l;++v)w+="var argType"+v+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+v+`');
var arg`+v+" = argType"+v+`.readValueFromPointer(args);
args += argType`+v+`['argPackAdvance'];
argTypes += 4;
`;return w+="var obj = new constructor("+h+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",w)(qe,n,it.toHandle,T)}var us={};function Sl(l,h,v,T){l=it.toValue(l);var w=us[h];return w||(w=Ol(h),us[h]=w),w(l,v,T)}function xl(l){return it.toHandle(or(l))}function Dl(l){var h=it.toValue(l);er(h),sr(l)}function Al(l,h){l=qe(l,"_emval_take_value");var v=l.readValueFromPointer(h);return it.toHandle(v)}function Ml(){Be("")}var cr=[];function kl(l,h){cr.length=0;var v;for(h>>=2;v=V[l++];)h+=v!=105&h,cr.push(v==105?z[h]:Ct[h++>>1]),++h;return cr}function Ll(l,h,v){var T=kl(h,v);return Sf[l].apply(null,T)}function Nl(l,h,v){return Ll(l,h,v)}function cs(){return 2147483648}function Rl(){return cs()}function bl(l,h,v){V.copyWithin(l,h,h+v)}function Il(l){try{return L.grow(l-$.byteLength+65535>>>16),ot(L.buffer),1}catch{}}function Fl(l){var h=V.length;l=l>>>0;var v=cs();if(l>v)return!1;let T=(C,I)=>C+(I-C%I)%I;for(var w=1;w<=4;w*=2){var S=h*(1+.2/w);S=Math.min(S,l+100663296);var E=Math.min(v,T(Math.max(l,S),65536)),O=Il(E);if(O)return!0}return!1}var fr={};function $l(){return s||"./this.program"}function oe(){if(!oe.strings){var l=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",h={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:l,_:$l()};for(var v in fr)fr[v]===void 0?delete h[v]:h[v]=fr[v];var T=[];for(var v in h)T.push(v+"="+h[v]);oe.strings=T}return oe.strings}function Vl(l,h,v){for(var T=0;T<l.length;++T)F[h++>>0]=l.charCodeAt(T);F[h>>0]=0}function Ul(l,h){var v=0;return oe().forEach(function(T,w){var S=h+v;P[l+w*4>>2]=S,Vl(T,S),v+=T.length+1}),0}function jl(l,h){var v=oe();P[l>>2]=v.length;var T=0;return v.forEach(function(w){T+=w.length+1}),P[h>>2]=T,0}function Pl(l){return 52}function zl(l,h,v,T){return 52}function Hl(l,h,v,T,w){return 70}var Gl=[null,[],[]];function Wl(l,h){var v=Gl[l];h===0||h===10?((l===1?y:p)(R(v,0)),v.length=0):v.push(h)}function Bl(l,h,v,T){for(var w=0,S=0;S<v;S++){var E=P[h>>2],O=P[h+4>>2];h+=8;for(var C=0;C<O;C++)Wl(l,V[E+C]);w+=O}return P[T>>2]=w,0}function Ze(l){return l%4===0&&(l%100!==0||l%400===0)}function Kl(l,h){for(var v=0,T=0;T<=h;v+=l[T++]);return v}var fs=[31,29,31,30,31,30,31,31,30,31,30,31],ls=[31,28,31,30,31,30,31,31,30,31,30,31];function Yl(l,h){for(var v=new Date(l.getTime());h>0;){var T=Ze(v.getFullYear()),w=v.getMonth(),S=(T?fs:ls)[w];if(h>S-v.getDate())h-=S-v.getDate()+1,v.setDate(1),w<11?v.setMonth(w+1):(v.setMonth(0),v.setFullYear(v.getFullYear()+1));else return v.setDate(v.getDate()+h),v}return v}function Xl(l,h,v){var T=j(l)+1,w=new Array(T);return b(l,w,0,w.length),w}function Ql(l,h){F.set(l,h)}function Jl(l,h,v,T){var w=z[T+40>>2],S={tm_sec:z[T>>2],tm_min:z[T+4>>2],tm_hour:z[T+8>>2],tm_mday:z[T+12>>2],tm_mon:z[T+16>>2],tm_year:z[T+20>>2],tm_wday:z[T+24>>2],tm_yday:z[T+28>>2],tm_isdst:z[T+32>>2],tm_gmtoff:z[T+36>>2],tm_zone:w?M(w):""},E=M(v),O={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var C in O)E=E.replace(new RegExp(C,"g"),O[C]);var I=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Q=["January","February","March","April","May","June","July","August","September","October","November","December"];function B(N,W,pt){for(var ft=typeof N=="number"?N.toString():N||"";ft.length<W;)ft=pt[0]+ft;return ft}function K(N,W){return B(N,W,"0")}function ct(N,W){function pt(en){return en<0?-1:en>0?1:0}var ft;return(ft=pt(N.getFullYear()-W.getFullYear()))===0&&(ft=pt(N.getMonth()-W.getMonth()))===0&&(ft=pt(N.getDate()-W.getDate())),ft}function st(N){switch(N.getDay()){case 0:return new Date(N.getFullYear()-1,11,29);case 1:return N;case 2:return new Date(N.getFullYear(),0,3);case 3:return new Date(N.getFullYear(),0,2);case 4:return new Date(N.getFullYear(),0,1);case 5:return new Date(N.getFullYear()-1,11,31);case 6:return new Date(N.getFullYear()-1,11,30)}}function Ot(N){var W=Yl(new Date(N.tm_year+1900,0,1),N.tm_yday),pt=new Date(W.getFullYear(),0,4),ft=new Date(W.getFullYear()+1,0,4),en=st(pt),ag=st(ft);return ct(en,W)<=0?ct(ag,W)<=0?W.getFullYear()+1:W.getFullYear():W.getFullYear()-1}var _t={"%a":function(N){return I[N.tm_wday].substring(0,3)},"%A":function(N){return I[N.tm_wday]},"%b":function(N){return Q[N.tm_mon].substring(0,3)},"%B":function(N){return Q[N.tm_mon]},"%C":function(N){var W=N.tm_year+1900;return K(W/100|0,2)},"%d":function(N){return K(N.tm_mday,2)},"%e":function(N){return B(N.tm_mday,2," ")},"%g":function(N){return Ot(N).toString().substring(2)},"%G":function(N){return Ot(N)},"%H":function(N){return K(N.tm_hour,2)},"%I":function(N){var W=N.tm_hour;return W==0?W=12:W>12&&(W-=12),K(W,2)},"%j":function(N){return K(N.tm_mday+Kl(Ze(N.tm_year+1900)?fs:ls,N.tm_mon-1),3)},"%m":function(N){return K(N.tm_mon+1,2)},"%M":function(N){return K(N.tm_min,2)},"%n":function(){return`
`},"%p":function(N){return N.tm_hour>=0&&N.tm_hour<12?"AM":"PM"},"%S":function(N){return K(N.tm_sec,2)},"%t":function(){return"	"},"%u":function(N){return N.tm_wday||7},"%U":function(N){var W=N.tm_yday+7-N.tm_wday;return K(Math.floor(W/7),2)},"%V":function(N){var W=Math.floor((N.tm_yday+7-(N.tm_wday+6)%7)/7);if((N.tm_wday+371-N.tm_yday-2)%7<=2&&W++,W){if(W==53){var ft=(N.tm_wday+371-N.tm_yday)%7;ft!=4&&(ft!=3||!Ze(N.tm_year))&&(W=1)}}else{W=52;var pt=(N.tm_wday+7-N.tm_yday-1)%7;(pt==4||pt==5&&Ze(N.tm_year%400-1))&&W++}return K(W,2)},"%w":function(N){return N.tm_wday},"%W":function(N){var W=N.tm_yday+7-(N.tm_wday+6)%7;return K(Math.floor(W/7),2)},"%y":function(N){return(N.tm_year+1900).toString().substring(2)},"%Y":function(N){return N.tm_year+1900},"%z":function(N){var W=N.tm_gmtoff,pt=W>=0;return W=Math.abs(W)/60,W=W/60*100+W%60,(pt?"+":"-")+("0000"+W).slice(-4)},"%Z":function(N){return N.tm_zone},"%%":function(){return"%"}};E=E.replace(/%%/g,"\0\0");for(var C in _t)E.includes(C)&&(E=E.replace(new RegExp(C,"g"),_t[C](S)));E=E.replace(/\0\0/g,"%");var Nt=Xl(E);return Nt.length>h?0:(Ql(Nt,l),Nt.length-1)}function ql(l,h,v,T,w){return Jl(l,h,v,T)}function Zl(l){_=l,gf()||(n.onExit&&n.onExit(l),A=!0),u(l,new Yi(l))}function tg(l,h){_=l,Zl(l)}function eg(l){if(l instanceof Yi||l=="unwind")return _;u(1,l)}Qi=n.InternalError=rr(Error,"InternalError"),$f(),ts=n.BindingError=rr(Error,"BindingError"),Pf(),rs=n.UnboundTypeError=rr(Error,"UnboundTypeError");var ng={b:Df,J:Af,F:Mf,L:kf,E:Lf,G:Nf,x:If,A:Ff,O:Vf,N:zf,v:Gf,g:tl,d:nl,c:rl,u:al,m:ll,y:gl,e:yl,P:hl,r:pl,i:dl,a:sr,p:ml,j:_l,s:El,f:Cl,o:Sl,w:xl,q:Dl,k:Al,n:Ml,h:Nl,D:Rl,M:bl,C:Fl,H:Ul,I:jl,l:Pl,K:zl,z:Hl,t:Bl,B:ql};Of(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.R).apply(null,arguments)},n._main=function(){return(n._main=n.asm.S).apply(null,arguments)};var lr=n._malloc=function(){return(lr=n._malloc=n.asm.U).apply(null,arguments)},Lt=n._free=function(){return(Lt=n._free=n.asm.V).apply(null,arguments)},gs=n.___getTypeName=function(){return(gs=n.___getTypeName=n.asm.W).apply(null,arguments)};n.__embind_initialize_bindings=function(){return(n.__embind_initialize_bindings=n.asm.X).apply(null,arguments)};var ys=n.___cxa_is_pointer_type=function(){return(ys=n.___cxa_is_pointer_type=n.asm.Y).apply(null,arguments)};n.dynCall_viij=function(){return(n.dynCall_viij=n.asm.Z).apply(null,arguments)},n.dynCall_vij=function(){return(n.dynCall_vij=n.asm._).apply(null,arguments)},n.dynCall_iij=function(){return(n.dynCall_iij=n.asm.$).apply(null,arguments)},n.dynCall_viji=function(){return(n.dynCall_viji=n.asm.aa).apply(null,arguments)},n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.ba).apply(null,arguments)},n.dynCall_viijii=function(){return(n.dynCall_viijii=n.asm.ca).apply(null,arguments)},n.dynCall_iiiiij=function(){return(n.dynCall_iiiiij=n.asm.da).apply(null,arguments)},n.dynCall_iiiiijj=function(){return(n.dynCall_iiiiijj=n.asm.ea).apply(null,arguments)},n.dynCall_iiiiiijj=function(){return(n.dynCall_iiiiiijj=n.asm.fa).apply(null,arguments)},n.___start_em_js=638316,n.___stop_em_js=638383;var tn;ie=function l(){tn||hs(),tn||(ie=l)};function rg(l){var h=n._main,v=0,T=0;try{var w=h(v,T);return tg(w,!0),w}catch(S){return eg(S)}}function hs(l){if(Gt>0||(yf(),Gt>0))return;function h(){tn||(tn=!0,n.calledRun=!0,!A&&(hf(),pf(),r(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),ps&&rg(),vf()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),h()},1)):h()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();var ps=!0;return n.noInitialRun&&(ps=!1),hs(),t.ready}})(),lc="/dicom-viewer-example/assets/ICRPolySeg-Ct3O4Qkv.wasm";class Kn{constructor(){this._instance}get instance(){if(this._instance)return this._instance;throw new Error("ICRPolySeg is not initialized.")}async initialize(t={}){this._instance=await fc({locateFile:n=>n.endsWith(".wasm")?lc:n,...t})}}function wi(e,t,n){return Math.abs(e-t)<=n}function gc(e,t,n=1e-5){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!wi(e[r],t[r],n))return!1;return!0}function _i(e){return typeof e=="number"}function Ei(e){return"length"in e&&typeof e[0]=="number"}function yc(e,t,n=1e-5){return typeof e!=typeof t||e===null||t===null?!1:_i(e)&&_i(t)?wi(e,t,n):Ei(e)&&Ei(t)?gc(e,t,n):!1}const{vtkErrorMacro:hc}=G,pc=[1,-1,1,-1,1,-1];function vc(e,t){t.classHierarchy.push("vtkPoints"),e.getNumberOfPoints=e.getNumberOfTuples,e.setNumberOfPoints=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;e.getNumberOfPoints()!==n&&(t.size=n*r,t.values=G.newTypedArray(t.dataType,t.size),e.setNumberOfComponents(r),e.modified())},e.setPoint=function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];e.setTuple(n,a)},e.getPoint=e.getTuple,e.findPoint=e.findTuple,e.insertNextPoint=(n,r,a)=>e.insertNextTuple([n,r,a]),e.getBounds=()=>{if(e.getNumberOfComponents()===3){const a=e.getRange(0);t.bounds[0]=a[0],t.bounds[1]=a[1];const i=e.getRange(1);t.bounds[2]=i[0],t.bounds[3]=i[1];const s=e.getRange(2);return t.bounds[4]=s[0],t.bounds[5]=s[1],t.bounds}if(e.getNumberOfComponents()!==2)return hc(`getBounds called on an array with components of
        ${e.getNumberOfComponents()}`),pc;const n=e.getRange(0);t.bounds[0]=n[0],t.bounds[1]=n[1];const r=e.getRange(1);return t.bounds[2]=r[0],t.bounds[3]=r[1],t.bounds[4]=0,t.bounds[5]=0,t.bounds},e.computeBounds=e.getBounds,e.setNumberOfComponents(t.numberOfComponents<2?3:t.numberOfComponents)}const dc={empty:!0,numberOfComponents:3,dataType:$e.FLOAT,bounds:[1,-1,1,-1,1,-1]};function Ci(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,dc,n),Dt.extend(e,t,n),vc(e,t)}var Yn={newInstance:G.newInstance(Ci,"vtkPoints"),extend:Ci};function Oi(e){let t=0;return e.filter((n,r)=>r===t?(t+=n+1,!0):!1)}function Si(e){let t=0;for(let n=0;n<e.length;)n+=e[n]+1,t++;return t}const mc={extractCellSizes:Oi,getNumberOfCells:Si};function Tc(e,t){t.classHierarchy.push("vtkCellArray");const n={...e};e.getNumberOfCells=r=>(t.numberOfCells!==void 0&&!r||(t.cellSizes?t.numberOfCells=t.cellSizes.length:t.numberOfCells=Si(e.getData())),t.numberOfCells),e.getCellSizes=r=>(t.cellSizes!==void 0&&!r||(t.cellSizes=Oi(e.getData())),t.cellSizes),e.resize=r=>{const a=e.getNumberOfTuples();n.resize(r);const i=e.getNumberOfTuples();i<a&&(i===0?(t.numberOfCells=0,t.cellSizes=[]):(t.numberOfCells=void 0,t.cellSizes=void 0))},e.setData=r=>{n.setData(r,1),t.numberOfCells=void 0,t.cellSizes=void 0},e.getCell=r=>{let a=r;const i=t.values[a++];return t.values.subarray(a,a+i)},e.insertNextCell=r=>{const a=e.getNumberOfCells();return e.insertNextTuples([r.length,...r]),++t.numberOfCells,t.cellSizes!=null&&t.cellSizes.push(r.length),a}}function wc(e){return{empty:!0,numberOfComponents:1,dataType:$e.UNSIGNED_INT,...e}}function xi(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Dt.extend(e,t,wc(n)),Tc(e,t)}var Di={newInstance:G.newInstance(xi,"vtkCellArray"),extend:xi,...mc};function _c(e,t){t.classHierarchy.push("vtkCell"),e.initialize=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(r){t.pointsIds=r;let a=t.points.getData();a.length!==3*t.pointsIds.length&&(a=G.newTypedArray(n.getDataType(),3*t.pointsIds.length));const i=n.getData();t.pointsIds.forEach((s,u)=>{let o=3*s,c=3*u;a[c]=i[o],a[++c]=i[++o],a[++c]=i[++o]}),t.points.setData(a)}else{t.points=n,t.pointsIds=new Array(n.getNumberOfPoints());for(let a=n.getNumberOfPoints()-1;a>=0;--a)t.pointsIds[a]=a}},e.getBounds=()=>{const n=t.points.getNumberOfPoints(),r=[];if(n){t.points.getPoint(0,r),t.bounds[0]=r[0],t.bounds[1]=r[0],t.bounds[2]=r[1],t.bounds[3]=r[1],t.bounds[4]=r[2],t.bounds[5]=r[2];for(let a=1;a<n;a++)t.points.getPoint(a,r),t.bounds[0]=r[0]<t.bounds[0]?r[0]:t.bounds[0],t.bounds[1]=r[0]>t.bounds[1]?r[0]:t.bounds[1],t.bounds[2]=r[1]<t.bounds[2]?r[1]:t.bounds[2],t.bounds[3]=r[1]>t.bounds[3]?r[1]:t.bounds[3],t.bounds[4]=r[2]<t.bounds[4]?r[2]:t.bounds[4],t.bounds[5]=r[2]>t.bounds[5]?r[2]:t.bounds[5]}else wu(t.bounds);return t.bounds},e.getLength2=()=>{e.getBounds();let n=0,r=0;for(let a=0;a<3;a++)r=t.bounds[2*a+1]-t.bounds[2*a],n+=r*r;return n},e.getParametricDistance=n=>{let r,a=0;for(let i=0;i<3;i++)n[i]<0?r=-n[i]:n[i]>1?r=n[i]-1:r=0,r>a&&(a=r);return a},e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.deepCopy=n=>{n.initialize(t.points,t.pointsIds)},e.getCellDimension=()=>{},e.intersectWithLine=(n,r,a,i,s,u,o)=>{},e.evaluatePosition=(n,r,a,i,s,u)=>{G.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}const Ec={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function Ai(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Ec,n),G.obj(e,t),t.points||(t.points=Yn.newInstance()),G.get(e,t,["points","pointsIds"]),_c(e,t)}var je={newInstance:G.newInstance(Ai,"vtkCell"),extend:Ai};function Cc(e,t){let n=t;for(t>=e.array.length&&(n+=e.array.length);n>e.array.length;)e.array.push({ncells:0,cells:null});e.array.length=n}function Oc(e,t){t.classHierarchy.push("vtkCellLinks"),e.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),a=n.getNumberOfCells(),i=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let s=0;s<a;++s){const{cellPointIds:u}=n.getCellPoints(s);u.forEach(o=>{e.incrementLinkCount(o)})}e.allocateLinks(r),t.maxId=r-1;for(let s=0;s<a;++s){const{cellPointIds:u}=n.getCellPoints(s);u.forEach(o=>{e.insertCellReference(o,i[o]++,s)})}}else{for(let s=0;s<a;s++)je.newInstance().getPointsIds().forEach(o=>{e.incrementLinkCount(o)});e.allocateLinks(r),t.maxId=r-1;for(let s=0;s<a;++s)je.newInstance().getPointsIds().forEach(o=>{e.insertCellReference(o,i[o]++,s)})}},e.allocate=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;t.array=Array(n).fill().map(()=>({ncells:0,cells:null})),t.extend=r,t.maxId=-1},e.initialize=()=>{t.array=null},e.getLink=n=>t.array[n],e.getNcells=n=>t.array[n].ncells,e.getCells=n=>t.array[n].cells,e.insertNextPoint=n=>{t.array.push({ncells:n,cells:Array(n)}),++t.maxId},e.insertNextCellReference=(n,r)=>{t.array[n].cells[t.array[n].ncells++]=r},e.deletePoint=n=>{t.array[n].ncells=0,t.array[n].cells=null},e.removeCellReference=(n,r)=>{t.array[r].cells=t.array[r].cells.filter(a=>a!==n),t.array[r].ncells=t.array[r].cells.length},e.addCellReference=(n,r)=>{t.array[r].cells[t.array[r].ncells++]=n},e.resizeCellList=(n,r)=>{t.array[n].cells.length=r},e.squeeze=()=>{Cc(t,t.maxId+1)},e.reset=()=>{t.maxId=-1},e.deepCopy=n=>{t.array=[...n.array],t.extend=n.extend,t.maxId=n.maxId},e.incrementLinkCount=n=>{++t.array[n].ncells},e.allocateLinks=n=>{for(let r=0;r<n;++r)t.array[r].cells=new Array(t.array[r].ncells)},e.insertCellReference=(n,r,a)=>{t.array[n].cells[r]=a}}const Sc={array:null,maxId:0,extend:0};function Mi(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Sc,n),G.obj(e,t),Oc(e,t)}var xc={newInstance:G.newInstance(Mi,"vtkCellLinks"),extend:Mi};const J={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_PIXEL:8,VTK_QUAD:9,VTK_TETRA:10,VTK_VOXEL:11,VTK_HEXAHEDRON:12,VTK_WEDGE:13,VTK_PYRAMID:14,VTK_PENTAGONAL_PRISM:15,VTK_HEXAGONAL_PRISM:16,VTK_QUADRATIC_EDGE:21,VTK_QUADRATIC_TRIANGLE:22,VTK_QUADRATIC_QUAD:23,VTK_QUADRATIC_POLYGON:36,VTK_QUADRATIC_TETRA:24,VTK_QUADRATIC_HEXAHEDRON:25,VTK_QUADRATIC_WEDGE:26,VTK_QUADRATIC_PYRAMID:27,VTK_BIQUADRATIC_QUAD:28,VTK_TRIQUADRATIC_HEXAHEDRON:29,VTK_QUADRATIC_LINEAR_QUAD:30,VTK_QUADRATIC_LINEAR_WEDGE:31,VTK_BIQUADRATIC_QUADRATIC_WEDGE:32,VTK_BIQUADRATIC_QUADRATIC_HEXAHEDRON:33,VTK_BIQUADRATIC_TRIANGLE:34,VTK_CUBIC_LINE:35,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42,VTK_PARAMETRIC_CURVE:51,VTK_PARAMETRIC_SURFACE:52,VTK_PARAMETRIC_TRI_SURFACE:53,VTK_PARAMETRIC_QUAD_SURFACE:54,VTK_PARAMETRIC_TETRA_REGION:55,VTK_PARAMETRIC_HEX_REGION:56,VTK_HIGHER_ORDER_EDGE:60,VTK_HIGHER_ORDER_TRIANGLE:61,VTK_HIGHER_ORDER_QUAD:62,VTK_HIGHER_ORDER_POLYGON:63,VTK_HIGHER_ORDER_TETRAHEDRON:64,VTK_HIGHER_ORDER_WEDGE:65,VTK_HIGHER_ORDER_PYRAMID:66,VTK_HIGHER_ORDER_HEXAHEDRON:67,VTK_LAGRANGE_CURVE:68,VTK_LAGRANGE_TRIANGLE:69,VTK_LAGRANGE_QUADRILATERAL:70,VTK_LAGRANGE_TETRAHEDRON:71,VTK_LAGRANGE_HEXAHEDRON:72,VTK_LAGRANGE_WEDGE:73,VTK_LAGRANGE_PYRAMID:74,VTK_NUMBER_OF_CELL_TYPES:75},Xn=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function Dc(e){return e<Xn.length?Xn[e]:"UnknownClass"}function Ac(e){return Xn.findIndex(e)}function Mc(e){return e<J.VTK_QUADRATIC_EDGE||e===J.VTK_CONVEX_POINT_SET||e===J.VTK_POLYHEDRON}function kc(e){return e===J.VTK_TRIANGLE_STRIP||e===J.VTK_POLY_LINE||e===J.VTK_POLY_VERTEX}const Lc={getClassNameFromTypeId:Dc,getTypeIdFromClassName:Ac,isLinear:Mc,hasSubCells:kc};function Nc(e,t){t.classHierarchy.push("vtkCellTypes"),e.allocate=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;t.size=n>0?n:1,t.extend=r>0?r:1,t.maxId=-1,t.typeArray=new Uint8Array(n),t.locationArray=new Uint32Array(n)},e.insertCell=(n,r,a)=>{t.typeArray[n]=r,t.locationArray[n]=a,n>t.maxId&&(t.maxId=n)},e.insertNextCell=(n,r)=>(e.insertCell(++t.maxId,n,r),t.maxId),e.setCellTypes=(n,r,a)=>{t.size=n,t.typeArray=r,t.locationArray=a,t.maxId=n-1},e.getCellLocation=n=>t.locationArray[n],e.deleteCell=n=>{t.typeArray[n]=J.VTK_EMPTY_CELL},e.getNumberOfTypes=()=>t.maxId+1,e.isType=n=>{const r=e.getNumberOfTypes();for(let a=0;a<r;++a)if(n===e.getCellType(a))return!0;return!1},e.insertNextType=n=>e.insertNextCell(n,-1),e.getCellType=n=>t.typeArray[n],e.reset=()=>{t.maxId=-1},e.deepCopy=n=>{e.allocate(n.getSize(),n.getExtend()),t.typeArray.set(n.getTypeArray()),t.locationArray.set(n.getLocationArray()),t.maxId=n.getMaxId()}}const Rc={size:0,maxId:-1,extend:1e3};function ki(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Rc,n),G.obj(e,t),G.get(e,t,["size","maxId","extend"]),G.getArray(e,t,["typeArray","locationArray"]),Nc(e,t)}var bc={newInstance:G.newInstance(ki,"vtkCellTypes"),extend:ki,...Lc},Li={IntersectionState:{NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2}};const{IntersectionState:Pe}=Li;function te(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;const a={t:Number.MIN_VALUE,distance:0},i=[];let s;i[0]=n[0]-t[0],i[1]=n[1]-t[1],i[2]=n[2]-t[2];const u=i[0]*(e[0]-t[0])+i[1]*(e[1]-t[1])+i[2]*(e[2]-t[2]),o=X(i,i);let c=1e-5*u;return o!==0&&(a.t=u/o),c<0&&(c=-c),-c<o&&o<c||o<=0||a.t<0?s=t:a.t>1?s=n:(s=i,i[0]=t[0]+a.t*i[0],i[1]=t[1]+a.t*i[1],i[2]=t[2]+a.t*i[2]),r&&(r[0]=s[0],r[1]=s[1],r[2]=s[2]),a.distance=St(s,e),a}function Ni(e,t,n,r,a,i){const s=[],u=[],o=[];a[0]=0,i[0]=0,bt(t,e,s),bt(r,n,u),bt(n,e,o);const c=[X(s,s),-X(s,u),-X(s,u),X(u,u)],f=[];if(f[0]=X(s,o),f[1]=-X(u,o),Tu(c,f,2)===0){let g=Number.MAX_VALUE;const y=[e,t,n,r],p=[n,n,e,e],d=[r,r,t,t];i[0],i[0],a[0],a[0],a[0],a[0],i[0],i[0];let m;for(let x=0;x<4;x++)m=te(y[x],p[x],d[x]),m.distance<g&&(g=m.distance);return Pe.ON_LINE}return a[0]=f[0],i[0]=f[1],a[0]>=0&&a[0]<=1&&i[0]>=0&&i[0]<=1?Pe.YES_INTERSECTION:Pe.NO_INTERSECTION}const Ic={distanceToLine:te,intersection:Ni};function Fc(e,t){t.classHierarchy.push("vtkLine");function n(r){return r>=0&&r<=1}e.getCellDimension=()=>1,e.intersectWithLine=(r,a,i,s,u)=>{const o={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};u[1]=0,u[2]=0;const c=[],f=[],g=[];t.points.getPoint(0,f),t.points.getPoint(1,g);const y=[],p=[],d=Ni(r,a,f,g,y,p);if(o.t=y[0],o.betweenPoints=n(o.t),u[0]=p[0],d===Pe.YES_INTERSECTION){for(let m=0;m<3;m++)s[m]=f[m]+u[0]*(g[m]-f[m]),c[m]=r[m]+o.t*(a[m]-r[m]);if(St(s,c)<=i*i)return o.intersect=1,o}else{let m;if(o.t<0)return m=te(r,f,g,s),m.distance<=i*i&&(o.t=0,o.intersect=1,o.betweenPoints=!0),o;if(o.t>1)return m=te(a,f,g,s),m.distance<=i*i&&(o.t=1,o.intersect=1,o.betweenPoints=!0),o;if(u[0]<0)return u[0]=0,m=te(f,r,a,s),o.t=m.t,m.distance<=i*i&&(o.intersect=1),o;if(u[0]>1)return u[0]=1,m=te(g,r,a,s),o.t=m.t,m.distance<=i*i&&(o.intersect=1),o}return o},e.evaluateLocation=(r,a,i)=>{const s=[],u=[];t.points.getPoint(0,s),t.points.getPoint(1,u);for(let o=0;o<3;o++)a[o]=s[o]+r[0]*(u[o]-s[o]);i[0]=1-r[0],i[1]=r[0]},e.evaluateOrientation=(r,a,i)=>t.orientations?(ke(a,t.orientations[0],t.orientations[1],r[0]),i[0]=1-r[0],i[1]=r[0],!0):!1}const $c={orientations:null};function Ri(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,$c,n),je.extend(e,t,n),G.setGet(e,t,["orientations"]),Fc(e,t)}var ht={newInstance:G.newInstance(Ri,"vtkLine"),extend:Ri,...Ic,...Li};function Vc(e,t){t.classHierarchy.push("vtkPointSet"),t.points?t.points=dt(t.points):t.points=Yn.newInstance(),e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.getBounds=()=>t.points.getBounds(),e.computeBounds=()=>{e.getBounds()};const n=e.shallowCopy;e.shallowCopy=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,a),t.points=Yn.newInstance(),t.points.shallowCopy(r.getPoints())}}const Uc={};function bi(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Uc,n),di.extend(e,t,n),G.setGet(e,t,["points"]),Vc(e,t)}var jc={newInstance:G.newInstance(bi,"vtkPointSet"),extend:bi};function Qn(e,t,n,r){const a=n[0]-t[0],i=n[1]-t[1],s=n[2]-t[2],u=e[0]-t[0],o=e[1]-t[1],c=e[2]-t[2];r[0]=i*c-s*o,r[1]=s*u-a*c,r[2]=a*o-i*u}function ze(e,t,n,r){Qn(e,t,n,r);const a=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);a!==0&&(r[0]/=a,r[1]/=a,r[2]/=a)}function Pc(e,t,n,r,a,i){let s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,u=!1;const o=[],c=[],f=[],g=[],y=[];ze(e,t,n,g),ze(r,a,i,y);const p=-X(g,e),d=-X(y,r),m=[X(y,e)+d,X(y,t)+d,X(y,n)+d];if(m[0]*m[1]>s&&m[0]*m[2]>s)return{intersect:!1,coplanar:u,pt1:o,pt2:c,surfaceId:f};const x=[X(g,r)+p,X(g,a)+p,X(g,i)+p];if(x[0]*x[1]>s&&x[0]*x[2]>s)return{intersect:!1,coplanar:u,pt1:o,pt2:c,surfaceId:f};if(Math.abs(g[0]-y[0])<1e-9&&Math.abs(g[1]-y[1])<1e-9&&Math.abs(g[2]-y[2])<1e-9&&Math.abs(p-d)<1e-9)return u=!0,{intersect:!1,coplanar:u,pt1:o,pt2:c,surfaceId:f};const L=[e,t,n],A=[r,a,i],_=X(g,y),D=(p-d*_)/(_*_-1),R=(d-p*_)/(_*_-1),M=[D*g[0]+R*y[0],D*g[1]+R*y[1],D*g[2]+R*y[2]],b=Oa(g,y,[]);vu(b);let k=0,j=0;const $=[],F=[];let V=50,H=50;for(let P=0;P<3;P++){const at=P,Ct=(P+1)%3,ot=jt.intersectWithLine(L[at],L[Ct],r,y);ot.intersection&&ot.t>0-s&&ot.t<1+s&&(ot.t<1+s&&ot.t>1-s&&(V=k),$[k++]=X(ot.x,b)-X(M,b));const lt=jt.intersectWithLine(A[at],A[Ct],e,g);lt.intersection&&lt.t>0-s&&lt.t<1+s&&(lt.t<1+s&&lt.t>1-s&&(H=j),F[j++]=X(lt.x,b)-X(M,b))}if(k>2){k--;const P=$[2];$[2]=$[V],$[V]=P}if(j>2){j--;const P=F[2];F[2]=F[H],F[H]=P}if(k!==2||j!==2)return{intersect:!1,coplanar:u,pt1:o,pt2:c,surfaceId:f};if(Number.isNaN($[0])||Number.isNaN($[1])||Number.isNaN(F[0])||Number.isNaN(F[1]))return{intersect:!1,coplanar:u,pt1:o,pt2:c,surfaceId:f};if($[0]>$[1]){const P=$[1];$[1]=$[0],$[0]=P}if(F[0]>F[1]){const P=F[1];F[1]=F[0],F[0]=P}let U,z;return $[1]<F[0]||F[1]<$[0]?{intersect:!1,coplanar:u,pt1:o,pt2:c,surfaceId:f}:($[0]<F[0]?$[1]<F[1]?(f[0]=2,f[1]=1,U=F[0],z=$[1]):(f[0]=2,f[1]=2,U=F[0],z=F[1]):$[1]<F[1]?(f[0]=1,f[1]=1,U=$[0],z=$[1]):(f[0]=1,f[1]=2,U=$[0],z=F[1]),Ca(M,b,U,o),Ca(M,b,z,c),{intersect:!0,coplanar:u,pt1:o,pt2:c,surfaceId:f})}const zc={computeNormalDirection:Qn,computeNormal:ze,intersectWithTriangle:Pc};function Hc(e,t){t.classHierarchy.push("vtkTriangle"),e.getCellDimension=()=>2,e.intersectWithLine=(n,r,a,i,s)=>{const u={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};s[2]=0;const o=[],c=a*a,f=[],g=[],y=[];t.points.getPoint(0,f),t.points.getPoint(1,g),t.points.getPoint(2,y);const p=[],d=[];if(ze(f,g,y,p),p[0]!==0||p[1]!==0||p[2]!==0){const _=jt.intersectWithLine(n,r,f,p);if(u.betweenPoints=_.betweenPoints,u.t=_.t,i[0]=_.x[0],i[1]=_.x[1],i[2]=_.x[2],!_.intersection)return s[0]=0,s[1]=0,u.intersect=0,u;const D=e.evaluatePosition(i,o,s,d);if(D.evaluation>=0)return D.dist2<=c?(u.intersect=1,u):(u.intersect=D.evaluation,u)}const m=St(f,g),x=St(g,y),L=St(y,f);t.line||(t.line=ht.newInstance()),m>x&&m>L?(t.line.getPoints().setPoint(0,f),t.line.getPoints().setPoint(1,g)):x>L&&x>m?(t.line.getPoints().setPoint(0,g),t.line.getPoints().setPoint(1,y)):(t.line.getPoints().setPoint(0,y),t.line.getPoints().setPoint(1,f));const A=t.line.intersectWithLine(n,r,a,i,s);if(u.betweenPoints=A.betweenPoints,u.t=A.t,A.intersect){const _=[],D=[],R=[];for(let M=0;M<3;M++)_[M]=f[M]-y[M],D[M]=g[M]-y[M],R[M]=i[M]-y[M];return s[0]=X(R,_)/L,s[1]=X(R,D)/x,u.intersect=1,u}return s[0]=0,s[1]=0,u.intersect=0,u},e.evaluatePosition=(n,r,a,i)=>{const s={subId:0,dist2:0,evaluation:-1};let u,o;const c=[],f=[],g=[],y=[];let p;const d=[],m=[],x=[];let L=0,A=0;const _=[];let D,R,M,b=[];const k=[],j=[],$=[];s.subId=0,a[2]=0,t.points.getPoint(1,c),t.points.getPoint(2,f),t.points.getPoint(0,g),Qn(c,f,g,y),jt.generalizedProjectPoint(n,c,y,$);let F=0;for(u=0;u<3;u++)y[u]<0?p=-y[u]:p=y[u],p>F&&(F=p,A=u);for(o=0,u=0;u<3;u++)u!==A&&(_[o++]=u);for(u=0;u<2;u++)d[u]=$[_[u]]-g[_[u]],m[u]=c[_[u]]-g[_[u]],x[u]=f[_[u]]-g[_[u]];if(L=Me(m,x),L===0)return a[0]=0,a[1]=0,s.evaluation=-1,s;if(a[0]=Me(d,x)/L,a[1]=Me(m,d)/L,i[0]=1-(a[0]+a[1]),i[1]=a[0],i[2]=a[1],i[0]>=0&&i[0]<=1&&i[1]>=0&&i[1]<=1&&i[2]>=0&&i[2]<=1)r&&(s.dist2=St($,n),r[0]=$[0],r[1]=$[1],r[2]=$[2]),s.evaluation=1;else{let V;if(r){if(i[1]<0&&i[2]<0)for(D=St(n,g),R=ht.distanceToLine(n,c,g,V,k),M=ht.distanceToLine(n,g,f,V,j),D<R?(s.dist2=D,b=g):(s.dist2=R,b=k),M<s.dist2&&(s.dist2=M,b=j),u=0;u<3;u++)r[u]=b[u];else if(i[2]<0&&i[0]<0)for(D=St(n,c),R=ht.distanceToLine(n,c,g,V,k),M=ht.distanceToLine(n,c,f,V,j),D<R?(s.dist2=D,b=c):(s.dist2=R,b=k),M<s.dist2&&(s.dist2=M,b=j),u=0;u<3;u++)r[u]=b[u];else if(i[1]<0&&i[0]<0)for(D=St(n,f),R=ht.distanceToLine(n,f,g,V,k),M=ht.distanceToLine(n,c,f,V,j),D<R?(s.dist2=D,b=f):(s.dist2=R,b=k),M<s.dist2&&(s.dist2=M,b=j),u=0;u<3;u++)r[u]=b[u];else if(i[0]<0){const H=ht.distanceToLine(n,c,f,r);s.dist2=H.distance}else if(i[1]<0){const H=ht.distanceToLine(n,f,g,r);s.dist2=H.distance}else if(i[2]<0){const H=ht.distanceToLine(n,c,g,r);s.dist2=H.distance}}s.evaluation=0}return s},e.evaluateLocation=(n,r,a)=>{const i=[],s=[],u=[];t.points.getPoint(0,i),t.points.getPoint(1,s),t.points.getPoint(2,u);const o=1-n[0]-n[1];for(let c=0;c<3;c++)r[c]=i[c]*o+s[c]*n[0]+u[c]*n[1];a[0]=o,a[1]=n[0],a[2]=n[1]},e.getParametricDistance=n=>{let r,a=0;const i=[];i[0]=n[0],i[1]=n[1],i[2]=1-n[0]-n[1];for(let s=0;s<3;s++)i[s]<0?r=-i[s]:i[s]>1?r=i[s]-1:r=0,r>a&&(a=r);return a}}const Gc={};function Ii(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Gc,n),je.extend(e,t,n),Hc(e,t)}var Wc={newInstance:G.newInstance(Ii,"vtkTriangle"),extend:Ii,...zc};const Jn=["verts","lines","polys","strips"],{vtkWarningMacro:Fi}=G,Bc={[J.VTK_LINE]:ht,[J.VTK_POLY_LINE]:ht,[J.VTK_TRIANGLE]:Wc};function Kc(e,t){t.classHierarchy.push("vtkPolyData");function n(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,i=>i.toUpperCase()).replace(/\s+/g,"")}Jn.forEach(a=>{e[`getNumberOf${n(a)}`]=()=>t[a].getNumberOfCells(),t[a]?t[a]=dt(t[a]):t[a]=Di.newInstance()}),e.getNumberOfCells=()=>Jn.reduce((a,i)=>a+t[i].getNumberOfCells(),0);const r=e.shallowCopy;e.shallowCopy=function(a){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(a,i),Jn.forEach(s=>{t[s]=Di.newInstance(),t[s].shallowCopy(a.getReferenceByName(s))})},e.buildCells=()=>{const a=e.getNumberOfVerts(),i=e.getNumberOfLines(),s=e.getNumberOfPolys(),u=e.getNumberOfStrips(),o=a+i+s+u,c=new Uint8Array(o);let f=c;const g=new Uint32Array(o);let y=g;if(a){let p=0;t.verts.getCellSizes().forEach((d,m)=>{y[m]=p,f[m]=d>1?J.VTK_POLY_VERTEX:J.VTK_VERTEX,p+=d+1}),y=y.subarray(a),f=f.subarray(a)}if(i){let p=0;t.lines.getCellSizes().forEach((d,m)=>{y[m]=p,f[m]=d>2?J.VTK_POLY_LINE:J.VTK_LINE,d===1&&Fi("Building VTK_LINE ",m," with only one point, but VTK_LINE needs at least two points. Check the input."),p+=d+1}),y=y.subarray(i),f=f.subarray(i)}if(s){let p=0;t.polys.getCellSizes().forEach((d,m)=>{switch(y[m]=p,d){case 3:f[m]=J.VTK_TRIANGLE;break;case 4:f[m]=J.VTK_QUAD;break;default:f[m]=J.VTK_POLYGON;break}d<3&&Fi("Building VTK_TRIANGLE ",m," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),p+=d+1}),y+=y.subarray(s),f+=f.subarray(s)}if(u){let p=0;f.fill(J.VTK_TRIANGLE_STRIP,0,u),t.strips.getCellSizes().forEach((d,m)=>{y[m]=p,p+=d+1})}t.cells=bc.newInstance(),t.cells.setCellTypes(o,c,g)},e.buildLinks=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;t.cells===void 0&&e.buildCells(),t.links=xc.newInstance(),a>0?t.links.allocate(a):t.links.allocate(e.getPoints().getNumberOfPoints()),t.links.buildLinks(e)},e.getCellType=a=>t.cells.getCellType(a),e.getCellPoints=a=>{const i=e.getCellType(a);let s=null;switch(i){case J.VTK_VERTEX:case J.VTK_POLY_VERTEX:s=t.verts;break;case J.VTK_LINE:case J.VTK_POLY_LINE:s=t.lines;break;case J.VTK_TRIANGLE:case J.VTK_QUAD:case J.VTK_POLYGON:s=t.polys;break;case J.VTK_TRIANGLE_STRIP:s=t.strips;break;default:return s=null,{type:0,cellPointIds:null}}const u=t.cells.getCellLocation(a),o=s.getCell(u);return{cellType:i,cellPointIds:o}},e.getPointCells=a=>t.links.getCells(a),e.getCellEdgeNeighbors=(a,i,s)=>{const u=t.links.getLink(i),o=t.links.getLink(s);return u.cells.filter(c=>c!==a&&o.cells.indexOf(c)!==-1)},e.getCell=function(a){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const s=e.getCellPoints(a),u=i||Bc[s.cellType].newInstance();return u.initialize(e.getPoints(),s.cellPointIds),u}}const Yc={};function $i(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Yc,n),jc.extend(e,t,n),G.get(e,t,["cells","links"]),G.setGet(e,t,["verts","lines","polys","strips"]),Kc(e,t)}var qn={newInstance:G.newInstance($i,"vtkPolyData"),extend:$i};const{vtkErrorMacro:Vi}=wa;function Xc(e){const t=e.getPolys().getData(),n=e.getStrips().getData(),r={cellSize:0,cell:[],done:!1,polyIdx:0,stripIdx:0,remainingStripLength:0,next(){if(r.polyIdx<t.length){r.cellSize=t[r.polyIdx];const a=r.polyIdx+1,i=a+r.cellSize;r.polyIdx=i;let s=0;for(let u=a;u<i;++u)r.cell[s++]=t[u]}else if(r.stripIdx<n.length){r.cellSize=3,r.remainingStripLength===0&&(r.remainingStripLength=n[r.stripIdx]-2,r.stripIdx+=3);const a=r.stripIdx-2,i=r.stripIdx+1;r.stripIdx++,r.remainingStripLength--;let s=0;for(let u=a;u<i;++u)r.cell[s++]=n[u]}else if(!r.done)r.done=!0;else throw new Error("Iterator is done")}};return r.next(),r}function Qc(e,t){t.classHierarchy.push("vtkCutter");const n={...e};e.getMTime=()=>{let a=n.getMTime();return t.cutFunction&&(a=Math.max(a,t.cutFunction.getMTime())),a};function r(a,i){const s=a.getPoints(),u=s.getData(),o=s.getNumberOfPoints(),c=[],f=[],g=[];(!t.cutScalars||t.cutScalars.length<o)&&(t.cutScalars=new Float32Array(o));let y=0,p=0;for(;y<u.length;)t.cutScalars[p++]=t.cutFunction.evaluateFunction(u[y++],u[y++],u[y++]);const d=[],m=new Array(3),x=new Array(3),L=[];for(const _=Xc(a);!_.done;_.next()){if(_.cellSize<=2)continue;for(let k=0;k<_.cellSize;)L[k]=t.cutScalars[_.cell[k++]];const D=L[0]>0;let R=!0;for(let k=1;k<_.cell.length;k++)if(L[k]>0!==D){R=!1;break}if(R)continue;const M=[];for(let k=0;k<_.cellSize;k++){const j=k+1===_.cellSize?0:k+1,$=L[k]>0;if(L[j]>0===$)continue;let V=k,H=j,U=L[H]-L[V];U<=0&&(V=j,H=k,U*=-1);let z=0;U!==0&&(z=(t.cutValue-L[V])/U);const P=_.cell[V],at=_.cell[H];m[0]=u[P*3],m[1]=u[P*3+1],m[2]=u[P*3+2],x[0]=u[at*3],x[1]=u[at*3+1],x[2]=u[at*3+2];const Ct=[m[0]+z*(x[0]-m[0]),m[1]+z*(x[1]-m[1]),m[2]+z*(x[2]-m[2])];M.push({pointEdge1:P,pointEdge2:at,intersectedPoint:Ct,newPointID:-1})}for(let k=0;k<M.length;k++){const j=M[k];let $=!1;for(let F=0;F<d.length;F++){const V=d[F],H=j.pointEdge1===V.pointEdge1&&j.pointEdge2===V.pointEdge2,U=j.intersectedPoint[0]===V.intersectedPoint[0]&&j.intersectedPoint[1]===V.intersectedPoint[1]&&j.intersectedPoint[2]===V.intersectedPoint[2];if(H||U){$=!0,M[k].newPointID=d[F].newPointID;break}}$||(c.push(j.intersectedPoint[0]),c.push(j.intersectedPoint[1]),c.push(j.intersectedPoint[2]),M[k].newPointID=c.length/3-1,d.push(M[k]))}const b=M.length;b===2?f.push(b,M[0].newPointID,M[1].newPointID):b>2&&(g.push(b),M.forEach(k=>{g.push(k.newPointID)}))}i.getPoints().setData(_e(s.getDataType(),c),3),f.length!==0&&i.getLines().setData(Uint16Array.from(f)),g.length!==0&&i.getPolys().setData(Uint16Array.from(g))}e.requestData=(a,i)=>{const s=a[0];if(!s){Vi("Invalid or missing input");return}if(!t.cutFunction){Vi("Missing cut function");return}const u=qn.newInstance();r(s,u),i[0]=u}}const Jc={cutFunction:null,cutScalars:null,cutValue:0};function Ui(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Jc,n),Ce(e,t),dn(e,t,1,1),Se(e,t,["cutFunction","cutValue"]),Qc(e,t)}var qc={newInstance:xe(Ui,"vtkCutter"),extend:Ui};function He(e,t){return e.worldToIndex(t).map(Math.round)}class Zc{constructor(t,n,r=1){this.rows=new Map,this.height=1,this.width=1,this.depth=1,this.jMultiple=1,this.kMultiple=1,this.numComps=1,this.defaultValue=0,this.pixelDataConstructor=Uint8Array,this.get=a=>{const i=a%this.jMultiple,s=(a-i)/this.jMultiple,u=this.getRLE(i,s);return(u==null?void 0:u.value)||this.defaultValue},this.getRun=(a,i)=>{const s=a+i*this.height;return this.rows.get(s)},this.set=(a,i)=>{if(i===void 0)throw new Error(`Can't set undefined at ${a%this.width}`);const s=a%this.width,u=(a-s)/this.width,o=this.rows.get(u);if(!o){this.rows.set(u,[{start:s,end:s+1,value:i}]);return}const c=this.findIndex(o,s),f=o[c],g=o[c-1];if(!f){if(!g||g.value!==i||g.end!==s){o[c]={start:s,end:s+1,value:i};return}g.end++;return}const{start:y,end:p,value:d}=f;if(i===d&&s>=y)return;const m={start:s,end:s+1,value:i},x=s>y,L=x?c+1:c,A=x?f:g;let _=x?o[c+1]:f;if((A==null?void 0:A.value)===i&&(A==null?void 0:A.end)===s){A.end++,(_==null?void 0:_.value)===i&&_.start===s+1?(A.end=_.end,o.splice(c,1)):(_==null?void 0:_.start)===s&&(_.start++,_.start===_.end&&(o.splice(c,1),_=o[c],(_==null?void 0:_.start)===s+1&&_.value===i&&(A.end=_.end,o.splice(c,1))));return}if((_==null?void 0:_.value)===i&&_.start===s+1){_.start--,(A==null?void 0:A.end)>s&&(A.end=s,A.end===A.start&&o.splice(c,1));return}if((_==null?void 0:_.start)===s&&_.end===s+1){_.value=i;const D=o[c+1];(D==null?void 0:D.start)==s+1&&D.value===i&&(o.splice(c+1,1),_.end=D.end);return}s===(_==null?void 0:_.start)&&_.start++,x&&p>s+1?o.splice(L,0,m,{start:s+1,end:A.end,value:A.value}):o.splice(L,0,m),(A==null?void 0:A.end)>s&&(A.end=s)},this.width=t,this.height=n,this.depth=r,this.jMultiple=t,this.kMultiple=this.jMultiple*n}getRLE(t,n,r=0){const a=this.rows.get(n+r*this.height);if(!a)return;const i=this.findIndex(a,t),s=a[i];return t>=(s==null?void 0:s.start)?s:void 0}findIndex(t,n){for(let r=0;r<t.length;r++){const{end:a}=t[r];if(n<a)return r}return t.length}clear(){this.rows.clear()}keys(){return[...this.rows.keys()]}getPixelData(t=0,n){n?n.fill(0):n=new this.pixelDataConstructor(this.width*this.height*this.numComps);const{width:r,height:a,numComps:i}=this;for(let s=0;s<a;s++){const u=this.getRun(s,t);if(u)if(i===1)for(const o of u){const c=s*r,{start:f,end:g,value:y}=o;for(let p=f;p<g;p++)n[c+p]=y}else for(const o of u){const c=s*r*i,{start:f,end:g,value:y}=o;for(let p=f;p<g;p+=i)for(let d=0;d<i;d++)n[c+p+d]=y[d]}}return n}}const tf=5*1024;class et{constructor(t,n,r){this.modifiedSlices=new Set,this.boundsIJK=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]],this.numComps=1,this.getAtIJK=(a,i,s)=>{const u=a+i*this.width+s*this.frameSize;return this._get(u)},this.setAtIJK=(a,i,s,u)=>{const o=a+i*this.width+s*this.frameSize;this._set(o,u)!==!1&&(this.modifiedSlices.add(s),et.addBounds(this.boundsIJK,[a,i,s]))},this.getAtIJKPoint=([a,i,s])=>this.getAtIJK(a,i,s),this.setAtIJKPoint=([a,i,s],u)=>this.setAtIJK(a,i,s,u),this.getAtIndex=a=>this._get(a),this.setAtIndex=(a,i)=>{if(this._set(a,i)!==!1){const s=this.toIJK(a);this.modifiedSlices.add(s[2]),et.addBounds(this.boundsIJK,s)}},this.forEach=(a,i)=>{const s=(i==null?void 0:i.boundsIJK)||this.getBoundsIJK(),{isWithinObject:u}=i||{};if(this.map)for(const o of this.map.keys()){const c=this.toIJK(o),g={value:this._get(o),index:o,pointIJK:c};(u==null?void 0:u(g))!==!1&&a(g)}else for(let o=s[2][0];o<=s[2][1];o++){const c=o*this.frameSize;for(let f=s[1][0];f<=s[1][1];f++){const g=c+f*this.width;for(let y=s[0][0],p=g+y;y<=s[0][1];y++,p++){const m={value:this.getAtIndex(p),index:p,pointIJK:[y,f,o]};(u==null?void 0:u(m))!==!1&&a(m)}}}},this.dimensions=t,this.width=t[0],this.frameSize=this.width*t[1],this._get=n,this._set=r}addPoint(t){const n=Array.isArray(t)?t[0]+this.width*t[1]+this.frameSize*t[2]:t;this.points||(this.points=new Set),this.points.add(n)}getPoints(){return this.points?[...this.points].map(t=>this.toIJK(t)):[]}getPointIndices(){return this.points?[...this.points]:[]}toIJK(t){return[t%this.width,Math.floor(t%this.frameSize/this.width),Math.floor(t/this.frameSize)]}toIndex(t){return t[0]+t[1]*this.width+t[2]*this.frameSize}getBoundsIJK(){return this.boundsIJK[0][0]<this.dimensions[0]?this.boundsIJK:this.dimensions.map(t=>[0,t-1])}clear(){var t;this.map&&this.map.clear(),this.boundsIJK.map(n=>{n[0]=1/0,n[1]=-1/0}),this.modifiedSlices.clear(),(t=this.points)==null||t.clear()}getArrayOfSlices(){return Array.from(this.modifiedSlices)}static addBounds(t,n){t||(t=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]]),t[0][0]=Math.min(n[0],t[0][0]),t[0][1]=Math.max(n[0],t[0][1]),t[1][0]=Math.min(n[1],t[1][0]),t[1][1]=Math.max(n[1],t[1][1]),t[2][0]=Math.min(n[2],t[2][0]),t[2][1]=Math.max(n[2],t[2][1])}static createRGBVolumeVoxelManager(t,n,r){const a=new et(t,i=>(i*=r,[n[i++],n[i++],n[i++]]),(i,s)=>{i*=3;const u=!yc(n[i],s);return n[i++]=s[0],n[i++]=s[1],n[i++]=s[2],u});return a.numComps=r,a.scalarData=n,a}static createVolumeVoxelManager(t,n,r=0){if(t.length!==3)throw new Error("Dimensions must be provided as [number, number, number] for [width, height, depth]");if(!r&&(r=n.length/t[0]/t[1]/t[2],r>4||r<1||r===2))throw new Error(`Number of components ${r} must be 1, 3 or 4`);return r>1?et.createRGBVolumeVoxelManager(t,n,r):et.createNumberVolumeVoxelManager(t,n)}static createNumberVolumeVoxelManager(t,n){const r=new et(t,a=>n[a],(a,i)=>{const s=n[a]!==i;return n[a]=i,s});return r.scalarData=n,r}static createMapVoxelManager(t){const n=new Map,r=new et(t,n.get.bind(n),(a,i)=>n.set(a,i)&&!0);return r.map=n,r}static createHistoryVoxelManager(t){const n=new Map,{dimensions:r}=t,a=new et(r,i=>n.get(i),function(i,s){if(n.has(i))s===n.get(i)&&n.delete(i);else{const u=this.sourceVoxelManager.getAtIndex(i);if(u===s)return!1;n.set(i,u)}this.sourceVoxelManager.setAtIndex(i,s)});return a.map=n,a.scalarData=t.scalarData,a.sourceVoxelManager=t,a}static createLazyVoxelManager(t,n){const r=new Map,[a,i,s]=t,u=a*i,o=new et(t,c=>{var f;return(f=r.get(Math.floor(c/u)))==null?void 0:f[c%u]},(c,f)=>{const g=Math.floor(c/u);let y=r.get(g);y||(y=n(a,i),r.set(g,y)),y[c%u]=f});return o.map=r,o}static createRLEVoxelManager(t){const[n,r,a]=t,i=new Zc(n,r,a),s=new et(t,u=>i.get(u),(u,o)=>i.set(u,o));return s.map=i,s.getPixelData=i.getPixelData.bind(i),s}static addInstanceToImage(t){const{width:n,height:r}=t,a=t.getPixelData();if((a==null?void 0:a.length)>=n*r){t.voxelManager=et.createVolumeVoxelManager([n,r,1],a);return}t.voxelManager=et.createRLEVoxelManager([n,r,1]),t.getPixelData=t.voxelManager.getPixelData,t.sizeInBytes=tf}}function ef(e,t){const n=[...e];return t>=n.length?(ji(n),n):(ji(n),n.slice(0,t))}function ji(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}}const Pi={Forward:1,Backward:-1},Ge=new Set;function nf(e,t){e.requestData=(n,r)=>{const[a]=n;r[0]||(r[0]=qn.newInstance());const[i]=r;e.extractContours(a,i),i.modified()},e.traverseLoop=(n,r,a,i,s)=>{let u=a,o=i,c=!1,f=0;for(;!c;){const{cellPointIds:g}=n.getCellPoints(u);if(!g)continue;o=g[0]!==o?g[0]:g[1],f++;const y=r*f;s.push({t:y,ptId:o});const p=n.getPointCells(o);if(p.length!==2||o===i)return o;p.length===2?(u=p[0]!==u?p[0]:p[1],Ge.add(u)):c=!0}return o},e.extractContours=(n,r)=>{var u;const a=[];Ge.clear();const i=n.getLines();r.getPoints().setData(Float32Array.from(n.getPoints().getData()));for(let o=0;o<i.getNumberOfCells();o++){if(Ge.has(o))continue;const{cellPointIds:c}=n.getCellPoints(o);if(!c)continue;Ge.add(o);const f=c[0],g=[];g.push({t:0,ptId:f});const y=e.traverseLoop(n,Pi.Forward,o,f,g);f!==y&&(e.traverseLoop(n,Pi.Backward,o,f,g),g.sort((p,d)=>p.t<d.t?-1:1),g.length&&g[0].ptId!==((u=g[g.length-1])==null?void 0:u.ptId)&&g.push({...g[g.length-1]})),g.length&&a.push(g)}const s=r.getLines();s.resize(0),a.forEach(o=>{s.insertNextCell(o.map(c=>c.ptId))})}}const rf={};function zi(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,rf,n),G.obj(e,t),G.algo(e,t,1,1),nf(e)}var af={newInstance:G.newInstance(zi,"vtkContourLoopExtraction"),extend:zi};function sf(e,t,n=!1){var f;let r=1/0,a=n?-1/0:0,i=1/0,s=n?-1/0:0,u=1/0,o=n?-1/0:0;const c=((f=e[0])==null?void 0:f.length)===3;for(let g=0;g<e.length;g++){const y=e[g];r=Math.min(y[0],r),a=Math.max(y[0],a),i=Math.min(y[1],i),s=Math.max(y[1],s),c&&(u=Math.min(y[2]??u,u),o=Math.max(y[2]??o,o))}return n||(r=Math.max(0,r),a=Math.min(1/0,a),i=Math.max(0,i),s=Math.min(1/0,s),c&&(u=Math.max(0,u),o=Math.min(1/0,o))),c?[[r,a],[i,s],[u,o]]:[[r,a],[i,s],null]}function Hi(e,t){return sf(e,t,!0)}function Zn(e,t,n,r){let a,i,s,u,o,c,f;const{numComps:g}=e;if(e.getScalarData?f=e.getScalarData():f=e.getPointData().getScalars().getData(),!f){console.warn("No scalar data found for imageData",e);return}const y=e.getDimensions();r?[[a,i],[s,u],[o,c]]=r:(a=0,i=y[0],s=0,u=y[1],o=0,c=y[2]);const p=rt(a,s,o),d=e.getDirection(),m=d.slice(0,3),x=d.slice(3,6),L=d.slice(6,9),A=e.getSpacing(),[_,D,R]=A,M=e.indexToWorld(p),b=rt(m[0]*_,m[1]*_,m[2]*_),k=rt(x[0]*D,x[1]*D,x[2]*D),j=rt(L[0]*R,L[1]*R,L[2]*R),$=g||f.length/y[2]/y[1]/y[0],F=y[0]*$,V=y[1]*F,H=[],U=kn(M);for(let z=o;z<=c;z++){const P=kn(U);for(let at=s;at<=u;at++){const Ct=kn(U);for(let ot=a;ot<=i;ot++){const lt=[ot,at,z];if(t(U,lt)){const Mt=z*V+at*F+ot*$;let Ht;$>2?Ht=[f[Mt],f[Mt+1],f[Mt+2]]:Ht=f[Mt],H.push({value:Ht,index:Mt,pointIJK:lt,pointLPS:U.slice()}),n&&n({value:Ht,index:Mt,pointIJK:lt,pointLPS:U})}Ln(U,U,b)}ka(U,Ct),Ln(U,U,k)}ka(U,P),Ln(U,U,j)}return H}function of(e,t){if(e.length!==t.length)throw Error("Both points should have the same dimensionality");const[n,r,a=0]=e,[i,s,u=0]=t,o=i-n,c=s-r,f=u-a;return o*o+c*c+f*f}function uf(e){if(e.length<3)return!1;const t=e.length,n=e[0],r=e[t-1],a=of(n,r);return _u(0,a)}function tr(e,t,n={closed:void 0}){if(e.length<3)return!1;const r=e.length;let a=0;const{closed:i,holes:s}=n;if(s!=null&&s.length){for(const c of s)if(tr(c,t))return!1}const u=!(i===void 0?uf(e):i),o=e.length-(u?1:2);for(let c=0;c<=o;c++){const f=e[c],g=c===r-1?0:c+1,y=e[g],p=f[0]>=y[0]?f[0]:y[0],d=f[1]>=y[1]?f[1]:y[1],m=f[1]<=y[1]?f[1]:y[1];if(t[0]<=p&&t[1]>=m&&t[1]<d){let A=f[0]===y[0];if(!A){const _=(t[1]-f[1])*(y[0]-f[0])/(y[1]-f[1])+f[0];A=t[0]<=_}a+=A?1:0}}return!!(a%2)}function Gi(e,t){let n=e;const r=(t==null?void 0:t.numDimensions)||2,a=r===3;if(!Array.isArray(e[0])){const g=e,y=g.length/r;n=new Array(g.length/r);for(let p=0,d=y;p<d;p++)n[p]=[g[p*r],g[p*r+1]],a&&n[p].push(g[p*r+2])}let i=1/0,s=1/0,u=-1/0,o=-1/0,c=1/0,f=-1/0;n=n;for(let g=0,y=n.length;g<y;g++){const[p,d,m]=n[g];i=i<p?i:p,s=s<d?s:d,u=u>p?u:p,o=o>d?o:d,a&&(c=c<m?c:m,f=f>m?f:m)}return a?{minX:i,maxX:u,minY:s,maxY:o,minZ:c,maxZ:f}:{minX:i,maxX:u,minY:s,maxY:o}}const cf=1e-6;function We(e){let t;const n=ef(e,50);for(let s=0;s<3;s++)if(n.every((u,o,c)=>Math.abs(u[s]-c[0][s])<cf)){t=s;break}if(t===void 0)throw new Error("Cannot find a shared dimension index for polyline, probably oblique plane");const r=[],a=(t+1)%3,i=(t+2)%3;for(let s=0;s<e.length;s++)r.push([e[s][a],e[s][i]]);return{sharedDimensionIndex:t,projectedPolyline:r}}const ff=(e,t,n,r,a,i,s,u)=>{const o=[rt(n,r,a),rt(i,r,a),rt(n,s,a),rt(i,s,a),rt(n,r,u),rt(i,r,u),rt(n,s,u),rt(i,s,u)],c=rt(t[0],t[1],t[2]),f=rt(e[0],e[1],e[2]),g=-Nn(c,f);let y=null;for(const p of o){const d=Nn(c,p)+g;if(y===null)y=Math.sign(d);else if(Math.sign(d)!==y)return!0}return!1};rn({polySeg:null,polySegInitializing:!1,polySegInitializingPromise:null,async initializePolySeg(e){var t;if(this.polySegInitializing){await this.polySegInitializingPromise;return}(t=this.polySeg)!=null&&t.instance||(this.polySegInitializing=!0,this.polySegInitializingPromise=new Promise(n=>{this.polySeg=new Kn,this.polySeg.initialize({updateProgress:e}).then(()=>{this.polySegInitializing=!1,n()})}),await this.polySegInitializingPromise)},async convertContourToSurface(e,...t){const{polylines:n,numPointsArray:r}=e,[a]=t;return await this.initializePolySeg(a),await this.polySeg.instance.convertContourRoiToSurface(n,r)},async convertLabelmapToSurface(e,...t){const[n]=t;return await this.initializePolySeg(n),this.polySeg.instance.convertLabelmapToSurface(e.scalarData,e.dimensions,e.spacing,e.direction,e.origin,[e.segmentIndex])},async convertContourToVolumeLabelmap(e,...t){const[n]=t;await(await new Kn).initialize({updateProgress:n});const{segmentIndices:a,scalarData:i,annotationUIDsInSegmentMap:s,dimensions:u,origin:o,direction:c,spacing:f}=e,g=et.createVolumeVoxelManager(u,i),y=Ue.newInstance();y.setDimensions(u),y.setOrigin(o),y.setDirection(c),y.setSpacing(f);const p=Dt.newInstance({name:"Pixels",numberOfComponents:1,values:i});y.getPointData().setScalars(p),y.modified();for(const d of a){const m=s.get(d);for(const x of m){if(!x.polyline)continue;const{polyline:L,holesPolyline:A}=x,_=Hi(L),[D,R,M]=He(y,[_[0][0],_[1][0],_[2][0]]),[b,k,j]=He(y,[_[0][1],_[1][1],_[2][1]]),{projectedPolyline:$,sharedDimensionIndex:F}=We(L),V=A==null?void 0:A.map(z=>{const{projectedPolyline:P}=We(z);return P}),H=(F+1)%3,U=(F+2)%3;Zn(y,z=>{const P=[z[H],z[U]];return tr($,P,{holes:V})},({pointIJK:z})=>{g.setAtIJKPoint(z,d)},[[D,b],[R,k],[M,j]])}}return g.scalarData},async convertContourToStackLabelmap(e,...t){const[n]=t;await(await new Kn).initialize({updateProgress:n});const{segmentationsInfo:a,annotationUIDsInSegmentMap:i,segmentIndices:s}=e,u=new Map;a.forEach((o,c)=>{const{dimensions:f,scalarData:g,direction:y,spacing:p,origin:d}=o,m=et.createVolumeVoxelManager(f,g),x=Ue.newInstance();x.setDimensions(f),x.setOrigin(d),x.setDirection(y),x.setSpacing(p);const L=Dt.newInstance({name:"Pixels",numberOfComponents:1,values:g});x.getPointData().setScalars(L),x.modified(),u.set(c,{manager:m,imageData:x})});for(const o of s){const c=i.get(o);for(const f of c){if(!f.polyline)continue;const{polyline:g,holesPolyline:y,referencedImageId:p}=f,d=Hi(g),{manager:m,imageData:x}=u.get(p),[L,A,_]=He(x,[d[0][0],d[1][0],d[2][0]]),[D,R,M]=He(x,[d[0][1],d[1][1],d[2][1]]),{projectedPolyline:b,sharedDimensionIndex:k}=We(g),j=y==null?void 0:y.map(V=>{const{projectedPolyline:H}=We(V);return H}),$=(k+1)%3,F=(k+2)%3;Zn(x,V=>{const H=[V[$],V[F]];return tr(b,H,{holes:j})},({pointIJK:V})=>{m.setAtIJKPoint(V,o)},[[L,D],[A,R],[_,M]])}}return a.forEach((o,c)=>{const{manager:f}=u.get(c);o.scalarData=f.scalarData}),a},async convertSurfaceToVolumeLabelmap(e,...t){const[n]=t;return await this.initializePolySeg(n),this.polySeg.instance.convertSurfaceToLabelmap(e.points,e.polys,e.dimensions,e.spacing,e.direction,e.origin)},async convertSurfacesToVolumeLabelmap(e,...t){const[n]=t;await this.initializePolySeg(n);const{segmentsInfo:r}=e,a=Array.from(r.keys()).map(g=>{const{points:y,polys:p}=r.get(g);return{...this.polySeg.instance.convertSurfaceToLabelmap(y,p,e.dimensions,e.spacing,e.direction,e.origin),segmentIndex:g}}),i=await Promise.all(a),s=Ue.newInstance();s.setDimensions(e.dimensions),s.setOrigin(e.origin),s.setSpacing(e.spacing),s.setDirection(e.direction);const u=e.dimensions[0]*e.dimensions[1]*e.dimensions[2],o=Dt.newInstance({name:"Pixels",numberOfComponents:1,values:new Uint8Array(u)});s.getPointData().setScalars(o),s.modified();const c=et.createVolumeVoxelManager(e.dimensions,s.getPointData().getScalars().getData()),f=i.map(g=>{const{data:y,dimensions:p,direction:d,origin:m,spacing:x}=g,L=Ue.newInstance();L.setDimensions(p),L.setOrigin(m),L.setSpacing(x),L.setDirection(d);const A=Dt.newInstance({name:"Pixels",numberOfComponents:1,values:y});L.getPointData().setScalars(A),L.modified();const _=et.createVolumeVoxelManager(p,y),D=L.getExtent();return{volume:L,voxelManager:_,extent:D,scalarData:y,segmentIndex:g.segmentIndex}});return Zn(s,()=>!0,({pointIJK:g,pointLPS:y})=>{try{for(const p of f){const{volume:d,extent:m,voxelManager:x,segmentIndex:L}=p,A=d.worldToIndex(y);if(A[0]<m[0]||A[0]>m[1]||A[1]<m[2]||A[1]>m[3]||A[2]<m[4]||A[2]>m[5])continue;const _=A.map(Math.round);if(x.getAtIJK(..._)>0){c.setAtIJKPoint(g,L);break}}}catch{}}),c.scalarData},getSurfacesAABBs({surfacesInfo:e}){const t=new Map;for(const{points:n,id:r}of e){const a=Gi(n,{numDimensions:3});t.set(r,a)}return t},cutSurfacesIntoPlanes({planesInfo:e,surfacesInfo:t,surfacesAABB:n=new Map},r,a){const i=e.length,s=qc.newInstance(),u=jt.newInstance();s.setCutFunction(u);const o=qn.newInstance();try{for(const[c,f]of e.entries()){const{sliceIndex:g,planes:y}=f,p=new Map;for(const d of t){const{points:m,polys:x,id:L}=d,A=n.get(L)||Gi(m,{numDimensions:3});n.has(L)||n.set(L,A);const{minX:_,minY:D,minZ:R,maxX:M,maxY:b,maxZ:k}=A,{origin:j,normal:$}=y[0];if(!ff(j,$,_,D,R,M,b,k))continue;o.getPoints().setData(m,3),o.getPolys().setData(x,3),o.modified(),s.setInputData(o),u.setOrigin(j),u.setNormal($);try{s.update()}catch(z){console.warn("Error during clipping",z);continue}const F=s.getOutputData(),V=F;V.buildLinks();const H=af.newInstance();H.setInputData(V);const U=H.getOutputData();F&&p.set(L,{points:U.getPoints().getData(),lines:U.getLines().getData(),numberOfCells:U.getLines().getNumberOfCells()})}r({progress:(c+1)/i}),a({sliceIndex:g,polyDataResults:p})}}catch(c){console.warn("Error during processing",c)}finally{t=null,u.delete()}}})})();
